"use strict";(self.webpackChunkhub_admin=self.webpackChunkhub_admin||[]).push([[386],{43386:(pt,S,l)=>{l.r(S),l.d(S,{TrackablesFeatureListModule:()=>dt,routes:()=>H});var c=l(36895),k=l(62510),s=l(24006),u=l(1576),h=l(56344),O=l(38586),F=l(33165),e=l(94650);let B=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[c.ez,s.u5,s.UX,u.ae,F.$]}),a})(),V=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[c.ez,u.ae,F.$,B]}),a})();var I=l(61135),p=l(65412),T=l(4859),y=l(68745),$=l(77579),G=l(56451),j=l(1336),L=l(39646),K=l(82805),A=l(63900),C=l(54004),X=l(70262);class z{static locatingRule(r){return t=>t.pristine?(0,L.of)(null):(0,K.H)(1e3).pipe((0,A.w)(()=>r.$isLocatingRule(t.value).pipe((0,C.U)(o=>o?{valueExists:!0}:null),(0,X.K)(o=>(0,L.of)({locatingRule:o.message})))))}}let U=(()=>{class a{constructor(t,o){this.formBuilder=t,this.validatorService=o,this.formSubject=new I.X(new s.nJ({})),this.form$=this.formSubject.asObservable(),this.formValueSubject=new I.X([]),this.formValue$=this.formValueSubject.asObservable()}resetForm(){this.form=this.formBuilder.group({rules:this.formBuilder.array([])}),this.formSub&&this.formSub.unsubscribe(),this.formSub=(0,G.T)(this.form.statusChanges,this.form.valueChanges).pipe().subscribe(()=>{this.form.valid&&this.formValueSubject.next(this.form.value?.rules)})}createItem(t=null,o=null){return this.formBuilder.group({expression:[{value:t,disabled:!1},[s.kI.required],[z.locatingRule(this.validatorService)]],priority:[{value:o,disabled:!1},s.kI.required]})}addItem(){const t=this.createItem();this.form?.get("rules").push(t),this.formSubject.next(this.form)}removeItem(t){this.form?.get("rules").removeAt(t)}toFormGroup(t){if(this.resetForm(),!Array.isArray(t))return;const o=this.form?.get("rules");t.forEach(i=>{const n=this.createItem(i.expression,i.priority);o.push(n)}),this.formSubject.next(this.form)}payLoad(){return this.form.getRawValue()}}return a.\u0275fac=function(t){return new(t||a)(e.LFG(s.QS),e.LFG(j.oP))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac}),a})();var d=l(59549),w=l(44144);function W(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"div")(1,"form",1),e._UZ(2,"deephub-forms-locating-rule-list",2),e.TgZ(3,"button",3),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onAdd())}),e._uU(4," add "),e.qZA()()()}if(2&a){const t=r.ngIf,o=e.oxw();let i;e.xp6(1),e.Q6J("formGroup",t),e.xp6(1),e.Q6J("list",o.getList(t))("change",null!==(i=null==(i=o.getList(t))?null:i.length)&&void 0!==i?i:0),e.xp6(1),e.uIk("data-cy","locating.rule.form.button.add")}}function ee(a,r){if(1&a&&(e.TgZ(0,"fieldset",2),e._UZ(1,"deephub-forms-locating-rule-item",3),e.qZA()),2&a){const t=r.$implicit,o=r.index;e.xp6(1),e.Q6J("formItem",t)("formIndex",o)}}function te(a,r){if(1&a&&(e.TgZ(0,"div"),e.YNc(1,ee,2,2,"ng-template",1),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",null==t.list?null:t.list.controls)("ngForTrackBy",t.trackByFn)}}function ae(a,r){1&a&&(e.TgZ(0,"mat-error"),e._uU(1," You must provide a "),e.TgZ(2,"strong"),e._uU(3,"expression"),e.qZA()()),2&a&&e.uIk("data-cy","locating.rule.expression.error.required")}function oe(a,r){if(1&a&&(e.TgZ(0,"div",13)(1,"mat-error"),e._uU(2),e.qZA()()),2&a){const t=e.oxw();e.xp6(1),e.uIk("data-cy","locating.rule.expression.error.locatingRule"),e.xp6(1),e.hij(" ",t.getError("expression","locatingRule")," ")}}function re(a,r){1&a&&(e.TgZ(0,"mat-error"),e._uU(1," You must provide a "),e.TgZ(2,"strong"),e._uU(3,"priority"),e.qZA()()),2&a&&e.uIk("data-cy","locating.rule.priority.error.required")}let ie=(()=>{class a{constructor(t){this.flrService=t,this.subs=new y.Y,this._locatingRules=[],this.changeValue=new e.vpe}set locatingRules(t){this._locatingRules=t,this.flrService.toFormGroup(t),this.subs.add(this.flrService.formValue$.subscribe(this.changeValue))}get locatingRules(){return this._locatingRules}ngOnDestroy(){this.subs.unsubscribe()}getList(t){return t.get("rules")}onAdd(){this.flrService.addItem()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(U))},a.\u0275cmp=e.Xpm({type:a,selectors:[["deephub-forms-locating-rule"]],inputs:{locatingRules:"locatingRules"},outputs:{changeValue:"changeValue"},features:[e._Bn([U])],decls:2,vars:3,consts:[[4,"ngIf"],[3,"formGroup"],[3,"list","change"],["mat-button","","cdkFocusInitial","",3,"click"]],template:function(t,o){1&t&&(e.YNc(0,W,5,4,"div",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,o.flrService.form$))},dependencies:function(){return[c.O5,s._Y,s.JL,s.sg,T.lW,ne,c.Ov]},encapsulation:2,changeDetection:0}),a})(),ne=(()=>{class a{constructor(){this.change=0}trackByFn(t){return t}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["deephub-forms-locating-rule-list"]],inputs:{list:"list",change:"change"},decls:1,vars:1,consts:[[4,"ngIf"],["ngFor","",3,"ngForOf","ngForTrackBy"],[1,"form-row","p0","m0"],[3,"formItem","formIndex"]],template:function(t,o){1&t&&e.YNc(0,te,2,2,"div",0),2&t&&e.Q6J("ngIf",o.list)},dependencies:function(){return[c.sg,c.O5,le]},encapsulation:2,changeDetection:0}),a})(),le=(()=>{class a{constructor(t){this.flrService=t,this.subs=new y.Y,this.expressionError=new $.x}set formItem(t){this._formItem=t,t&&this.subs.add(t.get("expression")?.statusChanges.subscribe(o=>{this.expressionError.next("INVALID"===o)}))}get formItem(){return this._formItem}ngOnDestroy(){this.subs.unsubscribe()}deleteItem(){this.flrService.removeItem(this.formIndex)}errorHandling(t,o){return this.formItem.controls[t].hasError(o)}getError(t,o){return this.formItem.controls[t].getError(o)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(U,4))},a.\u0275cmp=e.Xpm({type:a,selectors:[["deephub-forms-locating-rule-item"]],inputs:{formIndex:"formIndex",formItem:"formItem"},decls:21,vars:8,consts:[[3,"formGroup"],["fxLayout","row","fxLayoutAlign","center center"],["fxFlex","","appearance","outline",1,"full-width","pr12"],["matInput","","placeholder","expression","formControlName","expression"],[4,"ngIf"],["class","error-expression",4,"ngIf"],["fxFlex","15","appearance","outline",1,"full-width","pl12"],["matInput","","placeholder","Priority","type","number","formControlName","priority"],["fxFlex","none"],["mat-flat-button","","color","primary","data-cy","locating.rule.delete.button",1,"button-after-input","deleteIcon",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24"],["d","M19.5,7.5H4.5A.5.5,0,0,0,4,8V22a2,2,0,0,0,2,2H18a2,2,0,0,0,2-2V8A.5.5,0,0,0,19.5,7.5Zm-9.25,13a.75.75,0,0,1-1.5,0v-9a.75.75,0,0,1,1.5,0Zm5,0a.75.75,0,0,1-1.5,0v-9a.75.75,0,0,1,1.5,0Z"],["d","M22,4H17.25A.25.25,0,0,1,17,3.75V2.5A2.5,2.5,0,0,0,14.5,0h-5A2.5,2.5,0,0,0,7,2.5V3.75A.25.25,0,0,1,6.75,4H2A1,1,0,0,0,2,6H22a1,1,0,0,0,0-2ZM9,3.75V2.5A.5.5,0,0,1,9.5,2h5a.5.5,0,0,1,.5.5V3.75a.25.25,0,0,1-.25.25H9.25A.25.25,0,0,1,9,3.75Z"],[1,"error-expression"]],template:function(t,o){1&t&&(e.ynx(0,0),e.TgZ(1,"div",1)(2,"mat-form-field",2)(3,"mat-label"),e._uU(4,"Expression"),e.qZA(),e._UZ(5,"input",3),e.YNc(6,ae,4,1,"mat-error",4),e.YNc(7,oe,3,2,"div",5),e.ALo(8,"async"),e.qZA(),e.TgZ(9,"mat-form-field",6)(10,"mat-label"),e._uU(11,"Priority"),e.qZA(),e._UZ(12,"input",7),e.YNc(13,re,4,1,"mat-error",4),e.qZA(),e.TgZ(14,"div",8)(15,"button",9),e.NdJ("click",function(){return o.deleteItem()}),e.O4$(),e.TgZ(16,"svg",10)(17,"title"),e._uU(18,"delete"),e.qZA(),e._UZ(19,"path",11)(20,"path",12),e.qZA()()()(),e.BQk()),2&t&&(e.Q6J("formGroup",o.formItem),e.xp6(5),e.uIk("data-cy","locating.rule.expression"),e.xp6(1),e.Q6J("ngIf",o.errorHandling("expression","required")),e.xp6(1),e.Q6J("ngIf",e.lcZ(8,6,o.expressionError)),e.xp6(5),e.uIk("data-cy","locating.rule.priority"),e.xp6(1),e.Q6J("ngIf",o.errorHandling("priority","required")))},dependencies:[c.O5,s.Fj,s.wV,s.JJ,s.JL,s.sg,s.u,u.xw,u.Wh,u.yH,d.TO,d.KE,d.hX,w.Nt,T.lW,c.Ov],styles:[".error-expression{position:absolute;left:0;font-size:75%;margin-top:.6666666667em;top:100%}\n"],encapsulation:2,changeDetection:0}),a})(),D=(()=>{class a{constructor(t,o){this.dialogRef=t,this.data=o,this.locatingRules=new I.X([]),this.locatingRules$=this.locatingRules.asObservable(),this.title=o.title,o.locatingRules?.subscribe(i=>{this.locatingRules.next(i)}),this.update=o.update}onCancel(){this.dialogRef.close(!1)}setValue(t){this.rules=t}onSave(){this.rules&&this.update(this.rules).subscribe(()=>{this.dialogRef.close(!0)})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(p.so),e.Y36(p.WI))},a.\u0275cmp=e.Xpm({type:a,selectors:[["deephub-create-locating-rule-dialog"]],decls:12,vars:6,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"rule-content"],[3,"locatingRules","changeValue"],["mat-dialog-actions","","align","end"],["fxFlex","","fxLayoutAlign","start none"],["fxFlex","","fxLayoutAlign","end none"],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"h1",0),e._uU(1),e.qZA(),e.TgZ(2,"div",1)(3,"deephub-forms-locating-rule",2),e.NdJ("changeValue",function(n){return o.setValue(n)}),e.ALo(4,"async"),e.qZA()(),e.TgZ(5,"div",3),e._UZ(6,"div",4),e.TgZ(7,"div",5)(8,"button",6),e.NdJ("click",function(){return o.onCancel()}),e._uU(9," Cancel "),e.qZA(),e.TgZ(10,"button",7),e.NdJ("click",function(){return o.onSave()}),e._uU(11," Save "),e.qZA()()()),2&t&&(e.xp6(1),e.Oqu(o.title),e.xp6(2),e.Q6J("locatingRules",e.lcZ(4,4,o.locatingRules$)),e.xp6(5),e.uIk("data-cy","locating.rule.dialog.createEdit.button.cancel"),e.xp6(2),e.uIk("data-cy","locating.rule.dialog.createEdit.button.create"))},dependencies:[u.Wh,u.yH,T.lW,p.uh,p.xY,p.H8,ie,c.Ov],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}.rule-content[_ngcontent-%COMP%]{max-height:unset!important;flex:1 0 0}"],changeDetection:0}),a})();var se=l(27974),R=l(96308),f=l(30671),ce=l(39300),ue=l(50590);l(95944);var M=l(45551),me=l(65449),de=l(56709),P=l(97392),pe=l(74900),N=l(29521),fe=l(68675),Q=l(3238),Y=l(47957),Z=l(77331);const he=["locationInput"];function ge(a,r){1&a&&(e.TgZ(0,"mat-icon",11),e._uU(1,"cancel"),e.qZA())}function be(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"mat-chip",9),e.NdJ("removed",function(){const n=e.CHM(t).$implicit,x=e.oxw();return e.KtG(x.remove(n.id))}),e._uU(1),e.YNc(2,ge,2,0,"mat-icon",10),e.qZA()}if(2&a){const t=r.$implicit,o=e.oxw();e.Q6J("ngClass","backgroundColor-zone-type-"+t.type)("selectable",o.selectable)("removable",o.removable),e.uIk("data-cy","trackable.provider.chip."+t.id),e.xp6(1),e.hij(" ",t.id+" ("+t.type+")"," "),e.xp6(1),e.Q6J("ngIf",o.removable)}}function _e(a,r){if(1&a&&(e.TgZ(0,"mat-option",12),e._uU(1),e.qZA()),2&a){const t=r.$implicit;e.Q6J("value",t.id)("ngClass","border-zone-type border-zone-type-"+t.type),e.uIk("data-cy","trackable.provider.option."+t.id),e.xp6(1),e.hij(" ",t.id+" ("+t.type+")"," ")}}let ke=(()=>{class a{constructor(){this.visible=!0,this.selectable=!0,this.removable=!0,this.addOnBlur=!1,this.separatorKeysCodes=[N.K5,N.OC],this.locationCtrl=new s.p4,this.selectedLocationProviders=[],this._locationProviders=[]}set controlForm(t){this._controlForm=t,this.setSelectedLocationProviders()}get controlForm(){return this._controlForm}set locationProviders(t){this._locationProviders=t,this.filteredLocationProviders=this.locationCtrl.valueChanges.pipe((0,fe.O)(null),(0,C.U)(o=>this.removeSelectedLocationProviders(o?this._filter(o):this.locationProviders.slice()))),this.setSelectedLocationProviders()}get locationProviders(){return this._locationProviders}add(t){const o=t.input,i=t.value;(i||"").trim()&&this.addValueToForm(i.trim()),o&&(o.value=""),this.locationCtrl.setValue(null)}remove(t){const o=this.indexOf(t);o>=0&&(this.controlForm.value.splice(o,1),this.controlForm.updateValueAndValidity(),this.setSelectedLocationProviders(),this.locationCtrl.setValue(this.locationCtrl.value))}selected(t){this.addValueToForm(t.option.value),this.setSelectedLocationProviders(),this.locationInput.nativeElement.value="",this.locationCtrl.setValue(null)}removeSelectedLocationProviders(t){return t.filter(o=>-1===this.indexOf(o.id))}_filter(t){const o=t;return this.locationProviders.filter(i=>0===i.id.indexOf(o))}setSelectedLocationProviders(){!this.controlForm||!this.locationProviders||(this.selectedLocationProviders=this.controlForm.value.map(t=>this.getLocationProviderById(t)||{id:t,type:"notfound"}))}getLocationProviderById(t){const o=this.locationProviders.length;for(let i=0;i<o;i++)if(this.locationProviders[i].id===t)return this.locationProviders[i];return null}indexOf(t){const o=this.selectedLocationProviders.length;let i=0;for(;i<o;i++)if(this.selectedLocationProviders[i].id===t)return i;return-1}isValueInList(t){const o=this.locationProviders.length;let i=0;for(;i<o;i++)if(this.locationProviders[i].id===t)return!0;return!1}addValueToForm(t){!this.isValueInList(t)||(this.controlForm.value.push(t),this.controlForm.updateValueAndValidity())}}return a.\u0275fac=function(t){return new(t||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["deephub-multiple-location-providers-autocomplete"]],viewQuery:function(t,o){if(1&t&&e.Gf(he,5),2&t){let i;e.iGM(i=e.CRH())&&(o.locationInput=i.first)}},inputs:{controlForm:"controlForm",locationProviders:"locationProviders"},decls:12,vars:10,consts:[["appearance","outline",1,"full-width"],[3,"formControl"],["chipList",""],[3,"ngClass","selectable","removable","removed",4,"ngFor","ngForOf"],["placeholder","LocationProviders","data-cy","trackable.provider.input",3,"formControl","matAutocomplete","matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputAddOnBlur","matChipInputTokenEnd"],["locationInput",""],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value","ngClass",4,"ngFor","ngForOf"],[3,"ngClass","selectable","removable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""],[3,"value","ngClass"]],template:function(t,o){if(1&t&&(e.TgZ(0,"mat-form-field",0)(1,"mat-label"),e._uU(2,"LocationProviders"),e.qZA(),e.TgZ(3,"mat-chip-list",1,2),e.YNc(5,be,3,6,"mat-chip",3),e.TgZ(6,"input",4,5),e.NdJ("matChipInputTokenEnd",function(n){return o.add(n)}),e.qZA()(),e.TgZ(8,"mat-autocomplete",6,7),e.NdJ("optionSelected",function(n){return o.selected(n)}),e.YNc(10,_e,2,4,"mat-option",8),e.ALo(11,"async"),e.qZA()()),2&t){const i=e.MAs(4),n=e.MAs(9);e.xp6(3),e.Q6J("formControl",o.controlForm),e.xp6(2),e.Q6J("ngForOf",o.selectedLocationProviders),e.xp6(1),e.Q6J("formControl",o.locationCtrl)("matAutocomplete",n)("matChipInputFor",i)("matChipInputSeparatorKeyCodes",o.separatorKeysCodes)("matChipInputAddOnBlur",o.addOnBlur),e.xp6(4),e.Q6J("ngForOf",e.lcZ(11,8,o.filteredLocationProviders))}},dependencies:[c.mk,c.sg,c.O5,s.Fj,s.JJ,s.oH,d.KE,d.hX,Q.ey,Y.XC,Y.ZL,P.Hw,Z.qn,Z.HS,Z.oH,Z.qH,c.Ov],changeDetection:0}),a})();function Te(a,r){if(1&a&&(e.TgZ(0,"mat-form-field",7)(1,"mat-label"),e._uU(2,"ID"),e.qZA(),e._UZ(3,"input",19),e.qZA()),2&a){const t=e.oxw();e.xp6(3),e.uIk("data-cy","trackable.id."+t.type)}}function ve(a,r){1&a&&e._UZ(0,"div",20)}function xe(a,r){1&a&&(e.TgZ(0,"mat-error"),e._uU(1," You must provide a "),e.TgZ(2,"strong"),e._uU(3,"name"),e.qZA()()),2&a&&e.uIk("data-cy","trackable.name.create.error.required")}function ye(a,r){1&a&&(e.TgZ(0,"mat-error"),e._uU(1," The "),e.TgZ(2,"strong"),e._uU(3,"name"),e.qZA(),e._uU(4," must have at least 3 characters "),e.qZA()),2&a&&e.uIk("data-cy","trackable.name.create.error.min")}function Ce(a,r){if(1&a&&(e.TgZ(0,"mat-error"),e._uU(1," Must be a positive number or -1 "),e.qZA()),2&a){const t=e.oxw();e.uIk("data-cy","trackable.exit_delay."+t.type+".error.min")}}function Ze(a,r){if(1&a&&(e.TgZ(0,"mat-error"),e._uU(1," Must be a positive number or -1 "),e.qZA()),2&a){const t=e.oxw();e.uIk("data-cy","trackable.tolerance_timeout."+t.type+".error.min")}}function Fe(a,r){1&a&&(e.TgZ(0,"mat-error"),e._uU(1," The "),e.TgZ(2,"strong"),e._uU(3,"exit-tolerance"),e.qZA(),e._uU(4," must not be negative "),e.qZA())}function Ie(a,r){if(1&a&&(e.TgZ(0,"mat-error"),e._uU(1," Must be a positive number or -1 "),e.qZA()),2&a){const t=e.oxw();e.uIk("data-cy","trackable.fence_timeout."+t.type+".error.min")}}function Le(a,r){1&a&&(e.TgZ(0,"mat-error"),e._uU(1," The "),e.TgZ(2,"strong"),e._uU(3,"extrusion"),e.qZA(),e._uU(4," must not be negative "),e.qZA())}let Ae=(()=>{class a{constructor(t){this.formTrackableConfigService=t,this.showFieldId=!0,this.locationProviders=[],this.radiusInfoText="A radius provided in meters, defining the approximate circumference of the trackable. If a radius value is set, all position updates from any of the Location Providers will generate a circular geometry for the trackable, where the position is the center of the circle about which the circle will be generated with given radius.",this.exitDelayInfoText="The delay in milliseconds in which an imminent exit event should wait for another location update. This is relevant for fast rate position updates with quick moving objects. For example, an RTLS provider may batch location updates into groups, resulting in distances being temporarily outdated and premature events between quickly moving objects. The provided number must be positive or -1 in case of an infinite exit_delay. If not set or null, exit_delay will default to 0.",this.collisionToleranceInfoText="The minimum distance to a trackable in meters to release from an ongoing collision. For example, a trackable which was previously colliding with another trackable by being inside a trackables radius, the collision event will not be released from the collision until its distance to the trackables geometry is at least given exit_tolerance. Must be a positive number. If not set or null exit_tolerance will default to 0.",this.extrusionText="The extrusion to be applied to the geometry in meters. Must be a positive number.",this.toleranceTimeoutInfoText="The timeout in milliseconds after which a collision outside of a trackable, but within exit_tolerance distance to another obstacle, should release from a collision. Must be a positive number or -1 in case of an infinite timeout. If not set, or set to null, it will default to the fence timeout setting.",this.fenceTimeoutInfoText="The timeout in milliseconds after which a location should expire and trigger a fence exit event (if no more location updates are sent). Must be a positive number or -1 in case of an infinite timeout. If not set, or set to null, it will default to the fence timeout setting.",this.fenceForceLocationUpdate="If true, re-processes the most recent Location of the Location Providers assigned to this Trackable. No Location data stored in the hub will be changed. Events will be only generated in case of an actual change, for example if the new TrackableMotion causes the Trackable to enter a fence."}getTrackableTypes(){return this.formTrackableConfigService.getTrackableTypes}errorHandling(t,o){return this.form.controls[t].hasError(o)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(me.n))},a.\u0275cmp=e.Xpm({type:a,selectors:[["deephub-form-trackable-config"]],inputs:{type:"type",form:"form",showFieldId:"showFieldId",locationProviders:"locationProviders",change:"change"},decls:80,vars:27,consts:[[1,"m0","p0",3,"formGroup"],["fxLayout","row"],["fxFlex","50","class","full-width pr12","appearance","outline",4,"ngIf"],["fxFlex","50","class","full-width pr12",4,"ngIf"],["fxFlex","50","appearance","outline",1,"full-width","pl12"],["matInput","","placeholder","Name","formControlName","name"],[4,"ngIf"],["fxFlex","50","appearance","outline",1,"full-width","pr12"],["type","number","matInput","","placeholder","Exit-Delay","formControlName","exit_delay"],["matSuffix",""],["matSuffix","","deephubTooltip","",1,"suffix-button",3,"text"],["type","number","matInput","","placeholder","Radius","formControlName","radius"],["type","number","matInput","","placeholder","Tolerance-Timeout","formControlName","tolerance_timeout"],["type","number","matInput","","placeholder","Exit-Tolerance","formControlName","exit_tolerance"],["type","number","matInput","","placeholder","Fence-Timeout","formControlName","fence_timeout"],["matInput","","placeholder","Extrusion","formControlName","extrusion","type","number"],[3,"locationProviders","controlForm"],["fxFlex","50",1,"full-width","pl12"],["formControlName","force_location_update"],["matInput","","placeholder","Id","formControlName","id"],["fxFlex","50",1,"full-width","pr12"]],template:function(t,o){1&t&&(e.TgZ(0,"fieldset",0)(1,"div",1),e.YNc(2,Te,4,1,"mat-form-field",2),e.YNc(3,ve,1,0,"div",3),e.TgZ(4,"mat-form-field",4)(5,"mat-label"),e._uU(6,"Name"),e.qZA(),e._UZ(7,"input",5),e.YNc(8,xe,4,1,"mat-error",6),e.YNc(9,ye,5,1,"mat-error",6),e.qZA()(),e.TgZ(10,"div",1)(11,"mat-form-field",7)(12,"mat-label"),e._uU(13,"Exit-Delay"),e.qZA(),e._UZ(14,"input",8),e.TgZ(15,"span",9),e._uU(16,"ms"),e.qZA(),e.TgZ(17,"div",10)(18,"mat-icon"),e._uU(19,"info"),e.qZA()(),e.YNc(20,Ce,2,1,"mat-error",6),e.qZA(),e.TgZ(21,"mat-form-field",4)(22,"mat-label"),e._uU(23,"Radius"),e.qZA(),e._UZ(24,"input",11),e.TgZ(25,"span",9),e._uU(26,"m"),e.qZA(),e.TgZ(27,"div",10)(28,"mat-icon"),e._uU(29,"info"),e.qZA()()()(),e.TgZ(30,"div",1)(31,"mat-form-field",7)(32,"mat-label"),e._uU(33,"Tolerance-Timeout"),e.qZA(),e._UZ(34,"input",12),e.TgZ(35,"span",9),e._uU(36,"ms"),e.qZA(),e.TgZ(37,"div",10)(38,"mat-icon"),e._uU(39,"info"),e.qZA()(),e.YNc(40,Ze,2,1,"mat-error",6),e.qZA(),e.TgZ(41,"mat-form-field",4)(42,"mat-label"),e._uU(43,"Exit-Tolerance"),e.qZA(),e._UZ(44,"input",13),e.TgZ(45,"span",9),e._uU(46,"m"),e.qZA(),e.TgZ(47,"div",10)(48,"mat-icon"),e._uU(49,"info"),e.qZA()(),e.YNc(50,Fe,5,0,"mat-error",6),e.qZA()(),e.TgZ(51,"div",1)(52,"mat-form-field",7)(53,"mat-label"),e._uU(54,"Fence-Timeout"),e.qZA(),e._UZ(55,"input",14),e.TgZ(56,"span",9),e._uU(57,"ms"),e.qZA(),e.TgZ(58,"div",10)(59,"mat-icon"),e._uU(60,"info"),e.qZA()(),e.YNc(61,Ie,2,1,"mat-error",6),e.qZA(),e.TgZ(62,"mat-form-field",4)(63,"mat-label"),e._uU(64,"Extrusion"),e.qZA(),e._UZ(65,"input",15),e.TgZ(66,"span",9),e._uU(67,"m"),e.qZA(),e.TgZ(68,"div",10)(69,"mat-icon"),e._uU(70,"info"),e.qZA()(),e.YNc(71,Le,5,0,"mat-error",6),e.qZA()(),e._UZ(72,"deephub-multiple-location-providers-autocomplete",16),e.TgZ(73,"div",1)(74,"div",17)(75,"mat-checkbox",18),e._uU(76,"Force location update"),e.qZA(),e.TgZ(77,"div",10)(78,"mat-icon"),e._uU(79,"info"),e.qZA()()()()()),2&t&&(e.Q6J("formGroup",o.form),e.xp6(2),e.Q6J("ngIf",o.showFieldId),e.xp6(1),e.Q6J("ngIf",!o.showFieldId),e.xp6(4),e.uIk("data-cy","trackable.name."+o.type),e.xp6(1),e.Q6J("ngIf",o.errorHandling("name","required")),e.xp6(1),e.Q6J("ngIf",o.errorHandling("name","minlength")),e.xp6(5),e.uIk("data-cy","trackable.exit_delay."+o.type),e.xp6(3),e.Q6J("text",o.exitDelayInfoText),e.xp6(3),e.Q6J("ngIf",o.errorHandling("exit_delay","min")),e.xp6(4),e.uIk("data-cy","trackable.radius."+o.type),e.xp6(3),e.Q6J("text",o.radiusInfoText),e.xp6(7),e.uIk("data-cy","trackable.tolerance_timeout."+o.type),e.xp6(3),e.Q6J("text",o.toleranceTimeoutInfoText),e.xp6(3),e.Q6J("ngIf",o.errorHandling("tolerance_timeout","min")),e.xp6(4),e.uIk("data-cy","trackable.exit_tolerance."+o.type),e.xp6(3),e.Q6J("text",o.collisionToleranceInfoText),e.xp6(3),e.Q6J("ngIf",o.errorHandling("exit_tolerance","min")),e.xp6(5),e.uIk("data-cy","trackable.fence_timeout."+o.type),e.xp6(3),e.Q6J("text",o.fenceTimeoutInfoText),e.xp6(3),e.Q6J("ngIf",o.errorHandling("fence_timeout","min")),e.xp6(4),e.uIk("data-cy","trackable.extrusion."+o.type),e.xp6(3),e.Q6J("text",o.extrusionText),e.xp6(3),e.Q6J("ngIf",o.errorHandling("extrusion","min")),e.xp6(1),e.Q6J("locationProviders",o.locationProviders)("controlForm",o.form.get("location_providers")),e.xp6(3),e.uIk("data-cy","trackable.force_location_update."+o.type),e.xp6(2),e.Q6J("text",o.fenceForceLocationUpdate))},dependencies:[c.O5,s.Fj,s.wV,s.JJ,s.JL,s.sg,s.u,u.xw,u.yH,d.TO,d.KE,d.hX,d.R9,w.Nt,de.oG,P.Hw,pe.i,ke],changeDetection:0}),a})();function Ue(a,r){1&a&&(e.TgZ(0,"h1",10),e._uU(1,"New Trackable"),e.qZA())}function we(a,r){1&a&&(e.TgZ(0,"h1",10),e._uU(1,"Update Trackable"),e.qZA())}function Re(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onEdit())}),e._uU(1,"Edit"),e.qZA()}2&a&&e.uIk("data-cy","trackable.none.button.edit")}function Pe(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onUpdate())}),e._uU(1,"Update "),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("disabled",t.disabledUpdateShowButton()),e.uIk("data-cy","trackable.edit.button.update")}}function qe(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onSave())}),e._uU(1,"Save "),e.qZA()}if(2&a){const t=e.oxw();e.Q6J("disabled",t.disabledSaveShowButton()),e.uIk("data-cy","trackable.createEdit.button.create")}}let Je=(()=>{class a{constructor(t,o,i,n){this.dialogRef=t,this.trackableFacade=o,this.providersFacade=i,this.data=n,this.subs=new y.Y,this.change=!1,this.mode="create",this.fieldId=!1,this.form=this.trackableFacade.forms,this.mode=n.mode,"create"===n.mode?this.trackableFacade.formEnable():"edit"===n.mode?(this.fieldId=!0,this.onEdit()):"detail"===n.mode&&(this.fieldId=!0)}ngOnDestroy(){this.subs.unsubscribe()}onNoClick(){this.dialogRef.close(!1)}onSave(){this.form.markAllAsTouched(),this.change=!this.change,this.form.valid&&(this.trackableFacade.formDisable(),this.subs.add(this.trackableFacade.addTrackable(this.trackableFacade.forms.get("config").value).subscribe({next:()=>{this.trackableFacade.formEnable(),this.trackableFacade.loadTrackables(),this.dialogRef.close(!0)},error:()=>{this.trackableFacade.formEnable()}})))}editMode(){this.trackableFacade.updateValueForm(),this.trackableFacade.formEnable(),this.mode="edit"}onEdit(){this.subs.add(this.trackableFacade.loadTrackables$().pipe((0,A.w)(()=>this.providersFacade.loadProviders$())).subscribe(()=>this.editMode()))}onUpdate(){if(this.form.markAllAsTouched(),this.form.valid){this.trackableFacade.formDisable();const t=this.trackableFacade.getTrackableById(this.trackableFacade.forms.value.config.id),o=t?.locating_rules,i=t?.properties;this.subs.add(this.trackableFacade.updateTrackable({...this.trackableFacade.forms.value,locating_rules:o,properties:i}).subscribe({next:()=>{this.trackableFacade.formEnable(),this.trackableFacade.loadTrackables(),this.dialogRef.close(!0)},error:()=>{this.trackableFacade.formEnable()}}))}}isEditShowButton(){return"detail"===this.mode}isSaveShowButton(){return"create"===this.mode}isUpdateShowButton(){return"create"!==this.mode}disabledSaveShowButton(){return"create"!==this.mode}disabledUpdateShowButton(){return"edit"!==this.mode}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(p.so),e.Y36(h.ug),e.Y36(M.F),e.Y36(p.WI))},a.\u0275cmp=e.Xpm({type:a,selectors:[["deephub-create-trackable-dialog"]],decls:14,vars:14,consts:[["mat-dialog-title","",4,"ngIf"],["mat-dialog-content",""],[3,"formGroup"],[3,"form","locationProviders","showFieldId","change","type"],["mat-dialog-actions","","fxLayout","row"],["fxFlex","","fxLayoutAlign","start none"],["mat-button","","cdkFocusInitial","",3,"click",4,"ngIf"],["fxFlex","","fxLayoutAlign","end none"],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"disabled","click",4,"ngIf"],["mat-dialog-title",""],["mat-button","","cdkFocusInitial","",3,"click"],["mat-button","","cdkFocusInitial","",3,"disabled","click"]],template:function(t,o){1&t&&(e.YNc(0,Ue,2,0,"h1",0),e.YNc(1,we,2,0,"h1",0),e.TgZ(2,"div",1)(3,"form",2),e._UZ(4,"deephub-form-trackable-config",3),e.ALo(5,"async"),e.qZA()(),e.TgZ(6,"div",4)(7,"div",5),e.YNc(8,Re,2,1,"button",6),e.qZA(),e.TgZ(9,"div",7)(10,"button",8),e.NdJ("click",function(){return o.onNoClick()}),e._uU(11,"Cancel"),e.qZA(),e.YNc(12,Pe,2,2,"button",9),e.YNc(13,qe,2,2,"button",9),e.qZA()()),2&t&&(e.Q6J("ngIf",!o.fieldId),e.xp6(1),e.Q6J("ngIf",o.fieldId),e.xp6(2),e.Q6J("formGroup",o.form),e.xp6(1),e.Q6J("form",o.form.get("config"))("locationProviders",e.lcZ(5,12,o.providersFacade.providerList$))("showFieldId",o.fieldId)("change",o.change)("type",o.fieldId?"edit":"create"),e.xp6(4),e.Q6J("ngIf",o.isEditShowButton()),e.xp6(2),e.uIk("data-cy","trackable.edit.button.cancel"),e.xp6(2),e.Q6J("ngIf",o.isUpdateShowButton()),e.xp6(1),e.Q6J("ngIf",o.isSaveShowButton()))},dependencies:[c.O5,s._Y,s.JL,s.sg,u.xw,u.Wh,u.yH,T.lW,p.uh,p.xY,p.H8,Ae,c.Ov],changeDetection:0}),a})();var Se=l(48602),q=l(28255);function De(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"button",37),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.clear())}),e.TgZ(1,"mat-icon"),e._uU(2,"close"),e.qZA()()}}function Me(a,r){1&a&&(e.TgZ(0,"th",38),e._uU(1," Name "),e.qZA())}const g=function(a){return["/map/system/trackables","detail",a]},b=function(){return{tab:0}};function Ne(a,r){if(1&a&&(e.TgZ(0,"td",39),e._uU(1),e._UZ(2,"br"),e.TgZ(3,"span",40),e._uU(4),e.qZA()()),2&a){const t=r.$implicit,o=r.index,i=e.oxw();e.Q6J("routerLink",e.VKq(11,g,t.id))("queryParams",e.DdM(13,b))("queryParamsHandling","merge"),e.uIk("data-cy","trackable.list.element")("data-cy-id","trackable.list.element.id."+t.id)("data-cy-name","trackable.list.element.name."+i.removeSpace(t.name))("data-cy-sort","trackable.list.element.name."+o),e.xp6(1),e.hij(" ",t.name," "),e.xp6(2),e.uIk("data-cy","trackable.list.id."+o)("data-cy-name","trackable.list.id."+i.removeSpace(t.name)),e.xp6(1),e.Oqu(t.id)}}function Qe(a,r){1&a&&(e.TgZ(0,"th",41),e._uU(1," Radius (m) "),e.qZA())}function Ye(a,r){if(1&a&&(e.TgZ(0,"td",42),e._uU(1),e.qZA()),2&a){const t=r.$implicit,o=r.index;e.Q6J("routerLink",e.VKq(4,g,t.id))("queryParams",e.DdM(6,b)),e.uIk("data-cy-sort","trackable.list.element.radius."+o),e.xp6(1),e.hij(" ",t.radius," ")}}function He(a,r){1&a&&(e.TgZ(0,"th",43),e._uU(1," Exit-Delay (ms) "),e.qZA())}function Ee(a,r){if(1&a&&(e.TgZ(0,"td",42),e._uU(1),e.qZA()),2&a){const t=r.$implicit,o=r.index;e.Q6J("routerLink",e.VKq(4,g,t.id))("queryParams",e.DdM(6,b)),e.uIk("data-cy-sort","trackable.list.element.exit_delay."+o),e.xp6(1),e.hij(" ",t.exit_delay," ")}}function Oe(a,r){1&a&&(e.TgZ(0,"th",44),e._uU(1," Exit-Tolerance (m) "),e.qZA())}function Be(a,r){if(1&a&&(e.TgZ(0,"td",42),e._uU(1),e.qZA()),2&a){const t=r.$implicit,o=r.index;e.Q6J("routerLink",e.VKq(4,g,t.id))("queryParams",e.DdM(6,b)),e.uIk("data-cy-sort","trackable.list.element.exit_tolerance."+o),e.xp6(1),e.hij(" ",t.exit_tolerance||0," ")}}function Ve(a,r){1&a&&(e.TgZ(0,"th",45),e._uU(1," Tolerance-Timeout (ms) "),e.qZA())}function $e(a,r){if(1&a&&(e.TgZ(0,"td",42),e._uU(1),e.qZA()),2&a){const t=r.$implicit,o=r.index;e.Q6J("routerLink",e.VKq(4,g,t.id))("queryParams",e.DdM(6,b)),e.uIk("data-cy-sort","trackable.list.element.tolerance_timeout."+o),e.xp6(1),e.hij(" ",t.tolerance_timeout||0," ")}}function Ge(a,r){1&a&&(e.TgZ(0,"th",46),e._uU(1,"Properties"),e.qZA())}function je(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"button",49),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,n=e.oxw();return e.KtG(n.propertiesEdit(i.id))}),e._uU(1," Edit "),e.qZA()}if(2&a){const t=e.oxw(),o=t.index,i=t.$implicit,n=e.oxw();e.uIk("data-cy","trackable.list.properties.edit."+o)("data-cy-name","trackable.list.properties.edit."+n.removeSpace(i.name))}}function Ke(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"button",49),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,n=e.oxw();return e.KtG(n.propertiesEdit(i.id))}),e._uU(1," Add "),e.qZA()}if(2&a){const t=e.oxw(),o=t.index,i=t.$implicit,n=e.oxw();e.uIk("data-cy","trackable.list.properties.add."+o)("data-cy-name","trackable.list.properties.add."+n.removeSpace(i.name))}}function Xe(a,r){if(1&a&&(e.TgZ(0,"td",47),e.YNc(1,je,2,2,"button",48),e.YNc(2,Ke,2,2,"button",48),e.qZA()),2&a){const t=r.$implicit,o=e.oxw();e.xp6(1),e.Q6J("ngIf",o.hasProperties(t.properties)),e.xp6(1),e.Q6J("ngIf",!o.hasProperties(t.properties))}}function ze(a,r){1&a&&(e.TgZ(0,"th",46),e._uU(1,"Location Provider IDs"),e.qZA())}function We(a,r){if(1&a&&(e._UZ(0,"td",50),e.ALo(1,"async")),2&a){const t=r.$implicit,o=r.index,i=e.oxw();e.Q6J("routerLink",e.VKq(7,g,t.id))("queryParams",e.DdM(9,b))("innerHTML",e.lcZ(1,5,i.getLocationProvidersHTML(t.location_providers)),e.oJD),e.uIk("data-cy","trackable.list.locationProviders."+o)("data-cy-name","trackable.list.locationProviders."+i.removeSpace(t.name))}}function et(a,r){1&a&&(e.TgZ(0,"th",46),e._uU(1,"Rules"),e.qZA())}function tt(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"button",49),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,n=e.oxw();return e.KtG(n.rulesEdit(i.id))}),e._uU(1," Edit "),e.qZA()}if(2&a){const t=e.oxw(),o=t.index,i=t.$implicit,n=e.oxw();e.uIk("data-cy","trackable.list.rules.edit."+o)("data-cy-name","trackable.list.rules.edit."+n.removeSpace(i.name))}}function at(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"button",49),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,n=e.oxw();return e.KtG(n.rulesEdit(i.id))}),e._uU(1," Add "),e.qZA()}if(2&a){const t=e.oxw(),o=t.index,i=t.$implicit,n=e.oxw();e.uIk("data-cy","trackable.list.rules.add."+o)("data-cy-name","trackable.list.rules.add."+n.removeSpace(i.name))}}function ot(a,r){if(1&a&&(e.TgZ(0,"td",47),e.YNc(1,tt,2,2,"button",48),e.YNc(2,at,2,2,"button",48),e.qZA()),2&a){const t=r.$implicit,o=e.oxw();e.xp6(1),e.Q6J("ngIf",o.hasRules(t.locating_rules)),e.xp6(1),e.Q6J("ngIf",!o.hasRules(t.locating_rules))}}function rt(a,r){1&a&&(e.TgZ(0,"th",46),e._uU(1,"Actions"),e.qZA())}const it=function(a){return["/map/system/trackables","edit",a]},nt=function(){return{tab:1}};function lt(a,r){if(1&a){const t=e.EpF();e.TgZ(0,"td",51)(1,"button",52),e._UZ(2,"mat-icon",53),e.qZA(),e.TgZ(3,"mat-menu",null,54)(5,"button",55),e._uU(6," Edit "),e.qZA(),e.TgZ(7,"button",56),e.NdJ("click",function(){const n=e.CHM(t).$implicit,x=e.oxw();return e.KtG(x.deleteTrackable(n.id))}),e._uU(8," Delete "),e.qZA()()()}if(2&a){const t=r.$implicit,o=r.index,i=e.MAs(4),n=e.oxw();e.xp6(1),e.Q6J("matMenuTriggerFor",i),e.uIk("data-cy","trackable.menu.button."+o)("data-cy-name","trackable.menu.button."+n.removeSpace(t.name)),e.xp6(4),e.Q6J("routerLink",e.VKq(9,it,t.id))("queryParams",e.DdM(11,nt)),e.uIk("data-cy","trackable.menu.button.edit."+o)("data-cy-name","trackable.menu.button.edit."+n.removeSpace(t.name)),e.xp6(2),e.uIk("data-cy","trackable.menu.button.delete."+o)("data-cy-name","trackable.menu.button.delete."+n.removeSpace(t.name))}}function st(a,r){1&a&&e._UZ(0,"tr",57)}function ct(a,r){1&a&&e._UZ(0,"tr",58)}const ut=function(){return["/map/system/trackables","rules"]},mt=function(){return["/map/system/trackables","create"]};let v=(()=>{class a{constructor(t,o,i,n,x){this.activatedRoute=t,this.router=o,this.dialog=i,this.trackableFacade=n,this.providersFacade=x,this.subs=new y.Y,this.dialogOpen=!1,this.search="",this.displayedColumns=["name","radius","exit_delay","exit_tolerance","tolerance_timeout","properties","locationProviders","rules","star"],this.trackables=new f.by([]),this.subs.add(this.router.events.pipe((0,ce.h)(m=>m instanceof k.m2),(0,C.U)(()=>this.activatedRoute),(0,A.w)(m=>m.data.pipe((0,ue.P)()))).subscribe(m=>{if(this.dialogOpen)return;const _={width:"1000px",data:{}};this.trackableFacade.loadTrackables();let E=!1;if(this.setRestView(),"detail"===m.setting?.path)_.data.mode="detail",_.data.trackableId=m.setting.trackableId,this.trackableFacade.setId(m.setting.trackableId);else if("create"===m.setting?.path)_.data.mode="create";else if("rules"===m.setting?.path)E=!0;else{if("edit"!==m.setting?.path)return;_.data.trackableId=m.setting.trackableId,this.trackableFacade.setId(m.setting.trackableId),_.data.mode="edit"}if(E){this.dialogOpen=!0;const J=this.dialog.open(D,{width:"90vh",height:"70vh",data:{title:"Default Rules",locatingRules:this.trackableFacade.getDefaultRules(),update:this.saveRules.bind(this)}});this.subs.add(J.afterClosed().subscribe(()=>{this.dialogOpen=!1,this.router.navigateByUrl(this.router.createUrlTree(["/map/system","trackables","list"],{relativeTo:this.activatedRoute,queryParamsHandling:"merge",preserveFragment:!0}))}))}else{this.dialogOpen=!0;const J=this.dialog.open(Je,_);this.subs.add(J.afterClosed().subscribe(()=>{this.dialogOpen=!1,this.router.navigateByUrl(this.router.createUrlTree(["/map/system","trackables","list"],{relativeTo:this.activatedRoute,queryParamsHandling:"merge",preserveFragment:!0}))}))}}),this.trackableFacade.trackableList$.subscribe(m=>{this.trackables.data=m}))}static getLocationProviderById(t,o){const i=o.length;for(let n=0;n<i;n++)if(o[n].id===t)return o[n];return null}ngAfterViewInit(){this.trackables.paginator=this.paginator,this.trackables.sort=this.sort}ngOnDestroy(){this.subs.unsubscribe()}deleteTrackable(t){this.subs.add(this.trackableFacade.deleteTrackable(t).subscribe(()=>{this.trackableFacade.loadTrackables()}))}applyFilter(t){this.trackables.filter=t.trim().toLowerCase(),this.trackables.paginator&&this.trackables.paginator.firstPage()}clear(){this.search="",this.applyFilter(this.search)}getPropertyIcon(t){return t&&Object.keys(t).length?"done":"remove"}hasProperties(t){return t&&Object.keys(t).length}hasRules(t){return t?.length}saveProperties(t,o){const i=this.trackableFacade.getTrackableById(t),n=i?.locating_rules;return this.trackableFacade.updateTrackable({config:i,properties:o,locating_rules:n})}saveRules(t){return this.trackableFacade.saveRules(t)}saveTrackableRole(t){return o=>this.trackableFacade.saveTrackableRule(t,o)}rulesEdit(t){const o=this.trackableFacade.getTrackableById(t),i=this.dialog.open(D,{width:"90vh",height:"70vh",data:{title:`Trackable Rule of ${o.name||o.id}`,locatingRules:(0,L.of)(this.trackableFacade.getTrackableById(t)?.locating_rules),update:this.saveTrackableRole(t).bind(this)}});this.subs.add(i.afterClosed().subscribe(()=>{this.router.navigateByUrl(this.router.createUrlTree(["/map/system","trackables","list"],{relativeTo:this.activatedRoute,queryParamsHandling:"merge",preserveFragment:!0}))}))}propertiesEdit(t){const o=this.dialog.open(Se.f6,{width:"90vh",panelClass:"full-height",maxHeight:"70vh",minHeight:"400px",data:{value:this.trackableFacade.getTrackableById(t)?.properties,update:i=>this.saveProperties(t,i)}});this.subs.add(o.afterClosed().subscribe(i=>{i&&this.trackableFacade.loadTrackables()}))}setRestView(){this.trackableFacade.setId(null),this.trackableFacade.resetForm()}getLocationProvidersHTML(t){return this.providersFacade.providerList$.pipe((0,C.U)(o=>t.map(i=>a.getLocationProviderById(i,o)?`<span>${i}</span>`:`<span class="notfound">${i}</span>`).toString()))}removeSpace(t){return t?t.toString().replace(/\s+/g,""):""}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(k.gz),e.Y36(k.F0),e.Y36(p.uw),e.Y36(h.ug),e.Y36(M.F))},a.\u0275cmp=e.Xpm({type:a,selectors:[["deephub-trackable-list"]],viewQuery:function(t,o){if(1&t&&(e.Gf(se.NW,5),e.Gf(R.YE,5)),2&t){let i;e.iGM(i=e.CRH())&&(o.paginator=i.first),e.iGM(i=e.CRH())&&(o.sort=i.first)}},decls:53,vars:16,consts:[[1,"full_side"],[3,"fxLayout"],["fxLayoutAlign","start center",3,"fxFlex"],[1,"h1"],[1,"box-center",3,"fxFlex"],["appearance","outline"],["matPrefix",""],["matInput","","placeholder","Search and Filter Trackables","data-cy","trackable.search.input",3,"ngModel","keyup","ngModelChange"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear","data-cy","trackable.search.clear",3,"click",4,"ngIf"],["fxLayoutAlign","end center",3,"fxFlex"],["mat-line","","mat-stroked-button","","color","primary","data-cy","trackable.create.rules.button",1,"mr16",3,"routerLink","queryParamsHandling"],["mat-line","","mat-stroked-button","","color","primary","data-cy","trackable.create.button",3,"routerLink","queryParamsHandling"],[1,"with-icon"],[1,"table-viewport"],["mat-table","","matSort","","matSortActive","name","matSortDisableClear","","matSortDirection","asc",1,"is-full-width",3,"dataSource"],["matColumnDef","name","sticky",""],["mat-header-cell","","mat-sort-header","","data-cy","trackable.list.header.name",4,"matHeaderCellDef"],["mat-cell","",3,"routerLink","queryParams","queryParamsHandling",4,"matCellDef"],["matColumnDef","radius"],["mat-header-cell","","mat-sort-header","","data-cy","trackable.list.header.radius",4,"matHeaderCellDef"],["mat-cell","",3,"routerLink","queryParams",4,"matCellDef"],["matColumnDef","exit_delay"],["mat-header-cell","","mat-sort-header","","data-cy","trackable.list.header.exit_delay",4,"matHeaderCellDef"],["matColumnDef","exit_tolerance"],["mat-header-cell","","mat-sort-header","","data-cy","trackable.list.header.exit_tolerance",4,"matHeaderCellDef"],["matColumnDef","tolerance_timeout"],["mat-header-cell","","mat-sort-header","","data-cy","trackable.list.header.tolerance_timeout",4,"matHeaderCellDef"],["matColumnDef","properties"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","locationProviders"],["mat-cell","",3,"routerLink","queryParams","innerHTML",4,"matCellDef"],["matColumnDef","rules","stickyEnd",""],["matColumnDef","star","stickyEnd",""],["mat-cell","","class","column-center",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","","class","table-line-hover",4,"matRowDef","matRowDefColumns"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear","data-cy","trackable.search.clear",3,"click"],["mat-header-cell","","mat-sort-header","","data-cy","trackable.list.header.name"],["mat-cell","",3,"routerLink","queryParams","queryParamsHandling"],[1,"small"],["mat-header-cell","","mat-sort-header","","data-cy","trackable.list.header.radius"],["mat-cell","",3,"routerLink","queryParams"],["mat-header-cell","","mat-sort-header","","data-cy","trackable.list.header.exit_delay"],["mat-header-cell","","mat-sort-header","","data-cy","trackable.list.header.exit_tolerance"],["mat-header-cell","","mat-sort-header","","data-cy","trackable.list.header.tolerance_timeout"],["mat-header-cell",""],["mat-cell",""],["mat-line","","mat-stroked-button","","color","primary",3,"click",4,"ngIf"],["mat-line","","mat-stroked-button","","color","primary",3,"click"],["mat-cell","",3,"routerLink","queryParams","innerHTML"],["mat-cell","",1,"column-center"],["mat-icon-button","",3,"matMenuTriggerFor"],["fontSet","fa","fontIcon","fa-ellipsis-h",1,"fas"],["menu","matMenu"],["mat-menu-item","",3,"routerLink","queryParams"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row","",1,"table-line-hover"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),e._uU(4,"All Trackables"),e.qZA()(),e.TgZ(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),e._uU(8,"Search and Filter Trackables"),e.qZA(),e.TgZ(9,"mat-icon",6),e._uU(10,"search"),e.qZA(),e.TgZ(11,"input",7),e.NdJ("keyup",function(n){return o.applyFilter(n.target.value)})("ngModelChange",function(n){return o.search=n}),e.qZA(),e.YNc(12,De,3,0,"button",8),e.qZA()(),e.TgZ(13,"div",9)(14,"button",10)(15,"div"),e._uU(16,"Default Rules"),e.qZA()(),e.TgZ(17,"button",11)(18,"div",12)(19,"mat-icon"),e._uU(20,"add"),e.qZA(),e._uU(21," New Trackable "),e.qZA()()()(),e.TgZ(22,"div",13)(23,"table",14),e.ynx(24,15),e.YNc(25,Me,2,0,"th",16),e.YNc(26,Ne,5,14,"td",17),e.BQk(),e.ynx(27,18),e.YNc(28,Qe,2,0,"th",19),e.YNc(29,Ye,2,7,"td",20),e.BQk(),e.ynx(30,21),e.YNc(31,He,2,0,"th",22),e.YNc(32,Ee,2,7,"td",20),e.BQk(),e.ynx(33,23),e.YNc(34,Oe,2,0,"th",24),e.YNc(35,Be,2,7,"td",20),e.BQk(),e.ynx(36,25),e.YNc(37,Ve,2,0,"th",26),e.YNc(38,$e,2,7,"td",20),e.BQk(),e.ynx(39,27),e.YNc(40,Ge,2,0,"th",28),e.YNc(41,Xe,3,2,"td",29),e.BQk(),e.ynx(42,30),e.YNc(43,ze,2,0,"th",28),e.YNc(44,We,2,10,"td",31),e.BQk(),e.ynx(45,32),e.YNc(46,et,2,0,"th",28),e.YNc(47,ot,3,2,"td",29),e.BQk(),e.ynx(48,33),e.YNc(49,rt,2,0,"th",28),e.YNc(50,lt,9,12,"td",34),e.BQk(),e.YNc(51,st,1,0,"tr",35),e.YNc(52,ct,1,0,"tr",36),e.qZA()()()),2&t&&(e.xp6(1),e.Q6J("fxLayout","row"),e.xp6(1),e.Q6J("fxFlex",33),e.xp6(3),e.Q6J("fxFlex",33),e.xp6(6),e.Q6J("ngModel",o.search),e.xp6(1),e.Q6J("ngIf",o.search),e.xp6(1),e.Q6J("fxFlex",34),e.xp6(1),e.Q6J("routerLink",e.DdM(14,ut))("queryParamsHandling","merge"),e.xp6(3),e.Q6J("routerLink",e.DdM(15,mt))("queryParamsHandling","merge"),e.xp6(6),e.Q6J("dataSource",o.trackables),e.xp6(28),e.Q6J("matHeaderRowDef",o.displayedColumns)("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns))},dependencies:[c.O5,k.rH,d.KE,d.hX,d.qo,d.R9,w.Nt,Q.X2,T.lW,q.VK,q.OP,q.p6,f.BZ,f.fO,f.as,f.w1,f.Dz,f.nj,f.ge,f.ev,f.XQ,f.Gk,P.Hw,R.YE,R.nU,u.xw,u.Wh,u.yH,s.Fj,s.JJ,s.On,c.Ov],styles:["deephub-trackable-list{width:100%;padding-right:16px;padding-left:16px;position:absolute;top:0;bottom:0;z-index:100;background-color:#fff;box-sizing:border-box}.full_side{height:100%;margin:0 auto;box-sizing:border-box;position:relative}td{color:#878787}td .notfound{color:#d31a1a}.mat-form-field{font-size:14px;width:100%}.mat-row:hover{background-color:#f7fbfe}.mat-cell[ng-reflect-router-link]{cursor:pointer}.mat-cell span{padding-left:4px}.mat-cell:first-child span{padding-left:0}.table-viewport{height:calc(100vh - 209px);width:100%;overflow:auto}table{width:100%}th.mat-header-cell{background-color:#fcfcfc}.small{font-size:12px}.box-center{margin-top:5px}.mr16{margin-right:16px!important}\n"],encapsulation:2,changeDetection:0}),a})();const H=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"detail/:trackableId",component:v,resolve:{setting:h.UP}},{path:"create",component:v,resolve:{setting:h.UP}},{path:"edit/:trackableId",component:v,resolve:{setting:h.UP}},{path:"list",component:v,resolve:{setting:h.UP}},{path:"rules",component:v,resolve:{setting:h.UP}}];let dt=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[c.ez,k.Bz.forChild(H),h.mU,F.$,O.X,u.ae,s.u5,s.UX,V]}),a})()}}]);