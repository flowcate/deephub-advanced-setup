"use strict";(self.webpackChunkhub_admin=self.webpackChunkhub_admin||[]).push([[245],{5245:(Bt,O,s)=>{s.r(O),s.d(O,{ZoneShellModule:()=>Pt,routes:()=>W});var f=s(36895),v=s(62510),M=s(76139),d=s(80612),C=s(45022),L=s(27002),A=s(13017),F=s(73912),y=s(29055),B=s(33165),l=s(24006),J=s(68745),Q=s(39300),k=s(50590),ee=s(78372),H=s(18505),G=s(63900),U=s(54004),te=s(28746),oe=s(27524),e=s(94650),_=s(65412),x=s(1576),D=s(59549),ne=s(44144),ae=s(84385),q=s(3238),w=s(4859),R=s(47957),$=s(97392),N=s(86257),V=s(1949),ie=s(24088);function re(o,i){if(1&o&&(e.TgZ(0,"mat-option",19),e._uU(1),e.qZA()),2&o){const t=i.$implicit;e.Q6J("value",t.type),e.uIk("data-cy","zone.createType."+t.type),e.xp6(1),e.hij(" ",t.name," ")}}function se(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," You must select a "),e.TgZ(2,"strong"),e._uU(3,"definition method"),e.qZA()()),2&o&&e.uIk("data-cy","zone.createType.error")}function de(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.markErrors())}),e._uU(1," Next "),e.qZA()}2&o&&e.uIk("data-cy","create.first.next.button")}function ce(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onNextToSecond())}),e._uU(1," Next "),e.qZA()}2&o&&e.uIk("data-cy","create.first.next.button")}function le(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onNextToDetail())}),e._uU(1," Next "),e.qZA()}2&o&&e.uIk("data-cy","create.first.next.button")}function ue(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," You must provide a "),e.TgZ(2,"strong"),e._uU(3,"height"),e.qZA()()),2&o&&e.uIk("data-cy","zone.rectangle.height.error.required")}function pe(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," The "),e.TgZ(2,"strong"),e._uU(3,"height"),e.qZA(),e._uU(4," must not be negative "),e.qZA()),2&o&&e.uIk("data-cy","zone.rectangle.height.error.min")}function me(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," You must provide a "),e.TgZ(2,"strong"),e._uU(3,"width"),e.qZA()()),2&o&&e.uIk("data-cy","zone.rectangle.width.error.required")}function ge(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," The "),e.TgZ(2,"strong"),e._uU(3,"width"),e.qZA(),e._uU(4," must not be negative "),e.qZA()),2&o&&e.uIk("data-cy","zone.rectangle.width.error.min")}function he(o,i){if(1&o&&(e.TgZ(0,"mat-option",36)(1,"h4",37),e._uU(2),e.qZA(),e.TgZ(3,"p",37),e._uU(4),e.qZA()()),2&o){const t=i.$implicit,n=i.index;e.Q6J("value",t),e.uIk("data-cy","zone.rectangle.position."+n),e.xp6(2),e.Oqu(t.title),e.xp6(2),e.Oqu(t.subTitle)}}function fe(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",38),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.clearSearchField("subForm"))}),e.TgZ(1,"mat-icon"),e._uU(2,"close"),e.qZA()()}}function _e(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",22)(1,"div",23)(2,"mat-form-field",24)(3,"mat-label"),e._uU(4,"height of rectangle"),e.qZA(),e._UZ(5,"input",25),e.TgZ(6,"span",26),e._uU(7,"m"),e.qZA(),e.YNc(8,ue,4,1,"mat-error",9),e.YNc(9,pe,5,1,"mat-error",9),e.qZA(),e.TgZ(10,"mat-form-field",27)(11,"mat-label"),e._uU(12,"width of rectangle"),e.qZA(),e._UZ(13,"input",28),e.TgZ(14,"span",26),e._uU(15,"m"),e.qZA(),e.YNc(16,me,4,1,"mat-error",9),e.YNc(17,ge,5,1,"mat-error",9),e.qZA()(),e.TgZ(18,"h5"),e._uU(19,"Approximate Position"),e.qZA(),e.TgZ(20,"mat-form-field",29),e._UZ(21,"input",30),e.TgZ(22,"mat-autocomplete",31,32),e.NdJ("optionSelected",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.selectedPosition(a))}),e.YNc(24,he,5,4,"mat-option",33),e.ALo(25,"async"),e.qZA(),e.TgZ(26,"mat-icon",34),e._uU(27,"search"),e.qZA(),e.YNc(28,fe,3,0,"button",35),e.qZA()()}if(2&o){const t=e.MAs(23),n=e.oxw(2);e.xp6(5),e.uIk("data-cy","zone.rectangle.height"),e.xp6(3),e.Q6J("ngIf",n.errorHandling("height","required","subForm")),e.xp6(1),e.Q6J("ngIf",n.errorHandling("height","min","subForm")),e.xp6(4),e.uIk("data-cy","zone.rectangle.width"),e.xp6(3),e.Q6J("ngIf",n.errorHandling("width","required","subForm")),e.xp6(1),e.Q6J("ngIf",n.errorHandling("width","min","subForm")),e.xp6(4),e.Q6J("matAutocomplete",t),e.uIk("data-cy","zone.rectangle.position"),e.xp6(1),e.Q6J("displayWith",n.displayWith),e.xp6(2),e.Q6J("ngForOf",e.lcZ(25,11,n.searchPosition)),e.xp6(4),e.Q6J("ngIf",n.secondFormGroup.get("subForm").get("search").value)}}function Ze(o,i){if(1&o&&(e.TgZ(0,"div")(1,"h5"),e._uU(2,"Extent based geometries (height / width)"),e.qZA(),e.YNc(3,_e,29,13,"div",21),e.qZA()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.secondFormGroup.get("subForm"))}}function Fe(o,i){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Provide "),e.TgZ(2,"strong"),e._uU(3,"x"),e.qZA(),e._uU(4),e.qZA()),2&o){const t=e.oxw().index;e.uIk("data-cy","zone.local-coords.corner."+t+".x.error.required"),e.xp6(4),e.hij(" of Local Coordinate ",t+1," ")}}function ve(o,i){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1," The "),e.TgZ(2,"strong"),e._uU(3,"x"),e.qZA(),e._uU(4," must not be negative "),e.qZA()),2&o){const t=e.oxw().index;e.uIk("data-cy","zone.local-coords.corner."+t+".x.error.min")}}function xe(o,i){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Provide "),e.TgZ(2,"strong"),e._uU(3,"y"),e.qZA(),e._uU(4),e.qZA()),2&o){const t=e.oxw().index;e.uIk("data-cy","zone.local-coords.corner."+t+".y.error.required"),e.xp6(4),e.hij(" of Local Coordinate ",t+1," ")}}function ye(o,i){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1," The "),e.TgZ(2,"strong"),e._uU(3,"y"),e.qZA(),e._uU(4," must not be negative "),e.qZA()),2&o){const t=e.oxw().index;e.uIk("data-cy","zone.local-coords.corner."+t+".y.error.min")}}function be(o,i){if(1&o&&(e.TgZ(0,"div"),e.ynx(1,41),e.TgZ(2,"div",23),e._UZ(3,"mat-icon",42),e.TgZ(4,"mat-form-field",43)(5,"mat-label"),e._uU(6,"x value"),e.qZA(),e._UZ(7,"input",44),e.TgZ(8,"span",26),e._uU(9,"m"),e.qZA(),e.YNc(10,Fe,5,2,"mat-error",9),e.YNc(11,ve,5,1,"mat-error",9),e.qZA(),e.TgZ(12,"mat-form-field",45)(13,"mat-label"),e._uU(14,"y value"),e.qZA(),e._UZ(15,"input",46),e.TgZ(16,"span",26),e._uU(17,"m"),e.qZA(),e.YNc(18,xe,5,2,"mat-error",9),e.YNc(19,ye,5,1,"mat-error",9),e.qZA()(),e.BQk(),e.qZA()),2&o){const t=i.index,n=e.oxw(3);e.xp6(1),e.Q6J("formGroupName",t),e.xp6(2),e.s9C("svgIcon","Corner_0"+(t+1)),e.uIk("aria-label","Local Coordinate "+(t+1)),e.xp6(4),e.uIk("data-cy","zone.local-coords.corner."+t+".x"),e.xp6(3),e.Q6J("ngIf",n.errorHandlingArray("subForm",t,"x","required")),e.xp6(1),e.Q6J("ngIf",n.errorHandlingArray("subForm",t,"x","min")),e.xp6(4),e.uIk("data-cy","zone.local-coords.corner."+t+".y"),e.xp6(3),e.Q6J("ngIf",n.errorHandlingArray("subForm",t,"y","required")),e.xp6(1),e.Q6J("ngIf",n.errorHandlingArray("subForm",t,"y","min"))}}function Ce(o,i){if(1&o&&(e.TgZ(0,"mat-option",36)(1,"h4",37),e._uU(2),e.qZA(),e.TgZ(3,"p",37),e._uU(4),e.qZA()()),2&o){const t=i.$implicit,n=i.index;e.Q6J("value",t),e.uIk("data-cy","zone.local-coords.position."+n),e.xp6(2),e.Oqu(t.title),e.xp6(2),e.Oqu(t.subTitle)}}function Te(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",38),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.clearSearchField("subForm"))}),e.TgZ(1,"mat-icon"),e._uU(2,"close"),e.qZA()()}}function Ae(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",22)(1,"div",39),e.YNc(2,be,20,9,"div",40),e.qZA(),e.TgZ(3,"h5"),e._uU(4,"Approximate Position"),e.qZA(),e.TgZ(5,"mat-form-field",29),e._UZ(6,"input",30),e.TgZ(7,"mat-autocomplete",31,32),e.NdJ("optionSelected",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.selectedPosition(a))}),e.YNc(9,Ce,5,4,"mat-option",33),e.ALo(10,"async"),e.qZA(),e.TgZ(11,"mat-icon",34),e._uU(12,"search"),e.qZA(),e.YNc(13,Te,3,0,"button",35),e.qZA()()}if(2&o){const t=e.MAs(8),n=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",n.secondFormGroup.get("subForm").get("list").controls),e.xp6(4),e.Q6J("matAutocomplete",t),e.uIk("data-cy","zone.local-coords.position"),e.xp6(1),e.Q6J("displayWith",n.displayWith),e.xp6(2),e.Q6J("ngForOf",e.lcZ(10,6,n.searchPosition)),e.xp6(4),e.Q6J("ngIf",n.secondFormGroup.get("subForm").get("search").value)}}function ze(o,i){if(1&o&&(e.TgZ(0,"div")(1,"h5"),e._uU(2,"Local Coordinates"),e.qZA(),e.YNc(3,Ae,14,8,"div",21),e.qZA()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.secondFormGroup.get("subForm"))}}function Ie(o,i){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Provide "),e.TgZ(2,"strong"),e._uU(3,"longitude"),e.qZA(),e._uU(4),e.qZA()),2&o){const t=e.oxw().index;e.uIk("data-cy","zone.geo-coords.corner."+t+".lon.error.required"),e.xp6(4),e.hij(" of Coordinate ",t+1," ")}}function Ue(o,i){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Value must be "),e.TgZ(2,"strong"),e._uU(3,"greater"),e.qZA(),e._uU(4," than -180\xb0 "),e.qZA()),2&o){const t=e.oxw().index;e.uIk("data-cy","zone.geo-coords.corner."+t+".lon.error.min")}}function De(o,i){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Value must be "),e.TgZ(2,"strong"),e._uU(3,"less"),e.qZA(),e._uU(4," than 180\xb0 "),e.qZA()),2&o){const t=e.oxw().index;e.uIk("data-cy","zone.geo-coords.corner."+t+".lon.error.max")}}function we(o,i){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Provide "),e.TgZ(2,"strong"),e._uU(3,"latitude"),e.qZA(),e._uU(4),e.qZA()),2&o){const t=e.oxw().index;e.uIk("data-cy","zone.geo-coords.corner."+t+".lat.error.required"),e.xp6(4),e.hij(" of Coordinate ",t+1," ")}}function ke(o,i){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Value must be "),e.TgZ(2,"strong"),e._uU(3,"greater"),e.qZA(),e._uU(4," than -90\xb0 "),e.qZA()),2&o){const t=e.oxw().index;e.uIk("data-cy","zone.geo-coords.corner."+t+".lat.error.min")}}function qe(o,i){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Value must be "),e.TgZ(2,"strong"),e._uU(3,"less"),e.qZA(),e._uU(4," than 90\xb0 "),e.qZA()),2&o){const t=e.oxw().index;e.uIk("data-cy","zone.geo-coords.corner."+t+".lat.error.max")}}function Ne(o,i){if(1&o&&(e.TgZ(0,"div"),e.ynx(1,41),e.TgZ(2,"div",23),e._UZ(3,"mat-icon",42),e.TgZ(4,"mat-form-field",47)(5,"mat-label"),e._uU(6,"Longitude"),e.qZA(),e._UZ(7,"input",48),e.TgZ(8,"span",26),e._uU(9,"\xb0"),e.qZA(),e.YNc(10,Ie,5,2,"mat-error",9),e.YNc(11,Ue,5,1,"mat-error",9),e.YNc(12,De,5,1,"mat-error",9),e.qZA(),e.TgZ(13,"mat-form-field",45)(14,"mat-label"),e._uU(15,"Latitude"),e.qZA(),e._UZ(16,"input",49),e.TgZ(17,"span",26),e._uU(18,"\xb0"),e.qZA(),e.YNc(19,we,5,2,"mat-error",9),e.YNc(20,ke,5,1,"mat-error",9),e.YNc(21,qe,5,1,"mat-error",9),e.qZA()(),e.BQk(),e.qZA()),2&o){const t=i.index,n=e.oxw(3);e.xp6(1),e.Q6J("formGroupName",t),e.xp6(2),e.s9C("svgIcon","Corner_0"+(t+1)),e.uIk("aria-label","Geographic Coordinate "+(t+1)),e.xp6(4),e.uIk("data-cy","zone.geo-coords.corner."+t+".lon"),e.xp6(3),e.Q6J("ngIf",n.errorHandlingArray("subForm",t,"longitude","required")),e.xp6(1),e.Q6J("ngIf",n.errorHandlingArray("subForm",t,"longitude","min")),e.xp6(1),e.Q6J("ngIf",n.errorHandlingArray("subForm",t,"longitude","max")),e.xp6(4),e.uIk("data-cy","zone.geo-coords.corner."+t+".lat"),e.xp6(3),e.Q6J("ngIf",n.errorHandlingArray("subForm",t,"latitude","required")),e.xp6(1),e.Q6J("ngIf",n.errorHandlingArray("subForm",t,"latitude","min")),e.xp6(1),e.Q6J("ngIf",n.errorHandlingArray("subForm",t,"latitude","max"))}}function Ye(o,i){if(1&o&&(e.TgZ(0,"div",22)(1,"div",39),e.YNc(2,Ne,22,11,"div",40),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.secondFormGroup.get("subForm").get("list").controls)}}function Se(o,i){if(1&o&&(e.TgZ(0,"div")(1,"h5"),e._uU(2,"Geographic Coordinates (WGS 84)"),e.qZA(),e.YNc(3,Ye,3,1,"div",21),e.qZA()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.secondFormGroup.get("subForm"))}}function Me(o,i){1&o&&(e.TgZ(0,"div"),e._uU(1," DrawingOnMap "),e.qZA())}function Le(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Provide "),e.TgZ(2,"strong"),e._uU(3,"longitude"),e.qZA(),e._uU(4," of Coordinate "),e.qZA()),2&o&&e.uIk("data-cy","zone.geo-coord.lon.error.required")}function Je(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Value must be "),e.TgZ(2,"strong"),e._uU(3,"greater"),e.qZA(),e._uU(4," than -180\xb0 "),e.qZA()),2&o&&e.uIk("data-cy","zone.geo-coord.lon.error.min")}function Ge(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Value must be "),e.TgZ(2,"strong"),e._uU(3,"less"),e.qZA(),e._uU(4," than 180\xb0 "),e.qZA()),2&o&&e.uIk("data-cy","zone.geo-coord.lon.error.max")}function Pe(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Provide "),e.TgZ(2,"strong"),e._uU(3,"latitude"),e.qZA(),e._uU(4," of Coordinate "),e.qZA()),2&o&&e.uIk("data-cy","zone.geo-coord.lat.error.required")}function Ee(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Value must be "),e.TgZ(2,"strong"),e._uU(3,"greater"),e.qZA(),e._uU(4," than -90\xb0 "),e.qZA()),2&o&&e.uIk("data-cy","zone.geo-coord.lat.error.min")}function Oe(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Value must be "),e.TgZ(2,"strong"),e._uU(3,"less"),e.qZA(),e._uU(4," than 90\xb0 "),e.qZA()),2&o&&e.uIk("data-cy","zone.geo-coord.lat.error.max")}function Be(o,i){if(1&o&&(e.TgZ(0,"div"),e.ynx(1,41),e.TgZ(2,"div",23),e._UZ(3,"mat-icon",42),e.TgZ(4,"mat-form-field",47)(5,"mat-label"),e._uU(6,"Longitude"),e.qZA(),e._UZ(7,"input",48),e.TgZ(8,"span",26),e._uU(9,"\xb0"),e.qZA(),e.YNc(10,Le,5,1,"mat-error",9),e.YNc(11,Je,5,1,"mat-error",9),e.YNc(12,Ge,5,1,"mat-error",9),e.qZA(),e.TgZ(13,"mat-form-field",45)(14,"mat-label"),e._uU(15,"Latitude"),e.qZA(),e._UZ(16,"input",49),e.TgZ(17,"span",26),e._uU(18,"\xb0"),e.qZA(),e.YNc(19,Pe,5,1,"mat-error",9),e.YNc(20,Ee,5,1,"mat-error",9),e.YNc(21,Oe,5,1,"mat-error",9),e.qZA()(),e.BQk(),e.qZA()),2&o){const t=i.index,n=e.oxw(3);e.xp6(1),e.Q6J("formGroupName",t),e.xp6(2),e.s9C("svgIcon","SingleCoordinate"),e.uIk("aria-label","Geographic Coordinate"),e.xp6(4),e.uIk("data-cy","zone.geo-coord.lon"),e.xp6(3),e.Q6J("ngIf",n.errorHandlingArray("subForm",t,"longitude","required")),e.xp6(1),e.Q6J("ngIf",n.errorHandlingArray("subForm",t,"longitude","min")),e.xp6(1),e.Q6J("ngIf",n.errorHandlingArray("subForm",t,"longitude","max")),e.xp6(4),e.uIk("data-cy","zone.geo-coord.lat"),e.xp6(3),e.Q6J("ngIf",n.errorHandlingArray("subForm",t,"latitude","required")),e.xp6(1),e.Q6J("ngIf",n.errorHandlingArray("subForm",t,"latitude","min")),e.xp6(1),e.Q6J("ngIf",n.errorHandlingArray("subForm",t,"latitude","max"))}}function Qe(o,i){if(1&o&&(e.TgZ(0,"div",22)(1,"div",39),e.YNc(2,Be,22,11,"div",40),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",t.secondFormGroup.get("subForm").get("list").controls)}}function He(o,i){if(1&o&&(e.TgZ(0,"div")(1,"h5"),e._uU(2,"Geographic Coordinate (WGS 84)"),e.qZA(),e.YNc(3,Qe,3,1,"div",21),e.qZA()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("ngIf",t.secondFormGroup.get("subForm"))}}let Re=(()=>{class o{constructor(t,n,a,r,c,p){this.dialogRef=t,this.zoneFacade=n,this.formBuilder=a,this.mapFacade=r,this.geocoderService=c,this.mapConfigService=p,this.subs=new J.Y,this.isLoading=!1,this.searchError=!1,this.checkValue=!1,this.errorHandling=(m,u,h)=>h?this.secondFormGroup.get(h).controls[m].hasError(u):this.secondFormGroup.controls[m].hasError(u),this.createTypes=F.d4,this.form=this.zoneFacade.forms,this.zoneFacade.formEnable(),this.secondFormGroup=this.formBuilder.group({createType:["",l.kI.required]}),this.subs.add(this.mapConfigService.mapConfigInit$.pipe((0,Q.h)(m=>!0===m),(0,k.P)()).subscribe(()=>{console.log(this.mapConfigService.mapConfig),this.geocoder=this.geocoderService.getGeocoder(this.mapConfigService.mapConfig)})),this.handleCreateTypeFromZoneType(),this.handleCreateTypeSelection()}handleCreateTypeSelection(){this.subs.add(this.secondFormGroup.get("createType").valueChanges.subscribe(t=>{if(this.secondFormGroup.removeControl("subForm"),t===F.Ll.BasedGeometries){const n=this.formBuilder.group({height:["",[l.kI.required,l.kI.min(0)]],width:["",[l.kI.required,l.kI.min(0)]],search:[""]});this.secondFormGroup.setControl("subForm",n),this.secondFormGroup.updateValueAndValidity(),this.setSearchPosition()}else if(t===F.Ll.LocalCoordinates){const n=this.formBuilder.array([]);for(let r=0;r<4;r++)n.insert(r,this.formBuilder.group({x:["",[l.kI.required,l.kI.min(0)]],y:["",[l.kI.required,l.kI.min(0)]]}));const a=this.formBuilder.group({search:[""]});a.setControl("list",n),this.secondFormGroup.setControl("subForm",a),this.secondFormGroup.updateValueAndValidity(),this.setSearchPosition()}else if(t===F.Ll.GeographicCoordinates){const n=this.formBuilder.array([]);for(let r=0;r<4;r++)n.insert(r,this.formBuilder.group({longitude:[{value:"",disabled:!1},[l.kI.required,l.kI.pattern("[-]?([0-9]*[.])?[0-9]+"),l.kI.min(-180),l.kI.max(180)]],latitude:[{value:null,disabled:!1},[l.kI.required,l.kI.pattern("[-]?([0-9]*[.])?[0-9]+"),l.kI.min(-90),l.kI.max(90)]]}));const a=this.formBuilder.group({});a.setControl("list",n),this.secondFormGroup.setControl("subForm",a),this.secondFormGroup.updateValueAndValidity()}else if(t===F.mg.GeographicCoordinate){const n=this.formBuilder.array([]);n.insert(0,this.formBuilder.group({longitude:[{value:"",disabled:!1},[l.kI.required,l.kI.pattern("[-]?([0-9]*[.])?[0-9]+"),l.kI.min(-180),l.kI.max(180)]],latitude:[{value:null,disabled:!1},[l.kI.required,l.kI.pattern("[-]?([0-9]*[.])?[0-9]+"),l.kI.min(-90),l.kI.max(90)]]}));const a=this.formBuilder.group({});a.setControl("list",n),this.secondFormGroup.setControl("subForm",a),this.secondFormGroup.updateValueAndValidity()}}))}selectionChange(){}onNoClick(){this.dialogRef.close()}onNextToDetail(){this.secondFormGroup.markAllAsTouched(),this.secondFormGroup.valid&&this.dialogRef.close(this.secondFormGroup.value)}finishStepOne(){return this.form.valid}ngAfterViewInit(){this.mapFacade.onAdd(this.geocoder)}ngOnDestroy(){this.subs.unsubscribe(),this.geocoder&&this.geocoder.onRemove(),this.geocoder=null,this.searchPosition=null}errorHandlingArray(t,n,a,r){return this.secondFormGroup.get(t).get("list").controls[n].controls[a].hasError(r)}selectedPosition(t){const n=t?.option?.value;if(!n)return;const a=n.bbox;a?this.mapFacade.fitBounds([[a[0],a[1]],[a[2],a[3]]],{flyTo:!0}):this.mapFacade.flyTo({flyTo:!0,center:n.center})}displayWith(t){return t.place_name}setSearchPosition(){this.searchPosition=this.secondFormGroup.get("subForm").get("search").valueChanges.pipe((0,ee.b)(300),(0,Q.h)(t=>this.geocoderService.canSearch(t)),(0,H.b)(()=>this.isLoading=!0),(0,H.b)(()=>this.searchError=!1),(0,G.w)(t=>this.geocoder.geocode(t)),(0,U.U)(t=>(t.length||(this.searchError=!0),t)),(0,te.x)(()=>this.isLoading=!1))}clearSearchField(t){this.secondFormGroup.get(t).patchValue({search:""})}markErrors(){this.form.markAllAsTouched(),this.secondFormGroup.get("createType").markAsTouched(),this.checkValue=!0}onNextToSecond(){this.secondFormGroup.markAsPristine(),this.checkValue=!this.checkValue}handleCreateTypeFromZoneType(){this.subs.add(this.form.get("config").get("type").valueChanges.subscribe(t=>{const a=F.f9.find(r=>r.type===t);a&&(a.category===F.YQ.NonProximity?(this.form.get("config").get("need_transformation").setValue(!0),this.createTypes=F.sM):(this.form.get("config").get("need_transformation").setValue(!1),this.createTypes=F.LQ))}))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(_.so),e.Y36(F.Xq),e.Y36(l.QS),e.Y36(d.yk),e.Y36(oe.i),e.Y36(d.BA))},o.\u0275cmp=e.Xpm({type:o,selectors:[["deephub-create-zone-dialog"]],decls:39,vars:24,consts:[["mat-dialog-title",""],["linear","",1,"stepper-hiddenHeader",3,"selectionChange"],[3,"stepControl"],["mat-dialog-content",""],[3,"formGroup"],[3,"form","fieldId","type","change"],["appearance","outline",1,"full-width"],["formControlName","createType"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["mat-dialog-actions","","fxLayout","row"],["fxFlex","","fxLayoutAlign","start none"],["mat-button","",3,"click"],["fxFlex","","fxLayoutAlign","end none","data-cy","first-next"],["mat-button","",3,"click",4,"ngIf"],["mat-button","","matStepperNext","",3,"click",4,"ngIf"],["fxFlex","","fxLayoutAlign","end none","data-cy","second-next"],["mat-button","","matStepperPrevious",""],["mat-button","","matStepperNext","","cdkFocusInitial","",3,"click"],[3,"value"],["mat-button","","matStepperNext","",3,"click"],["formGroupName","subForm",4,"ngIf"],["formGroupName","subForm"],["fxLayout","row"],["fxFlex","50","appearance","outline",1,"full-width","pr12","text-suffix"],["matInput","","placeholder","height of rectangle","formControlName","height","type","number"],["matSuffix",""],["fxFlex","50","appearance","outline",1,"full-width","pl12","text-suffix"],["matInput","","placeholder","width of rectangle","formControlName","width","type","number"],["appearance","outline",1,"approx-position","full-width"],["matInput","","placeholder","Position","formControlName","search",3,"matAutocomplete"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],["uiMultiLineOption","",3,"value",4,"ngFor","ngForOf"],["matPrefix",""],["mat-button","","mat-icon-button","","matSuffix","",3,"click",4,"ngIf"],["uiMultiLineOption","",3,"value"],["mat-line",""],["mat-button","","mat-icon-button","","matSuffix","",3,"click"],["formGroupName","list",1,"list"],[4,"ngFor","ngForOf"],[3,"formGroupName"],["fxFlex","","aria-hidden","false",3,"svgIcon"],["fxFlex","45","appearance","outline",1,"full-width","pr12","text-suffix"],["matInput","","placeholder","x","formControlName","x","type","number"],["fxFlex","45","appearance","outline",1,"full-width","pl12","text-suffix"],["matInput","","placeholder","y","formControlName","y","type","number"],["fxFlex","45","appearance","outline",1,"full-width","pr12"],["matInput","","placeholder","longitude","formControlName","longitude","type","number"],["matInput","","placeholder","latitude","formControlName","latitude","type","number"]],template:function(t,n){1&t&&(e.TgZ(0,"h1",0),e._uU(1,"New Zone"),e.qZA(),e.TgZ(2,"mat-horizontal-stepper",1),e.NdJ("selectionChange",function(){return n.selectionChange()}),e.TgZ(3,"mat-step",2)(4,"div",3)(5,"form",4),e._UZ(6,"deephub-form-zone-config",5),e.qZA(),e.TgZ(7,"form",4)(8,"mat-form-field",6)(9,"mat-label"),e._uU(10,"Zone Definition via..."),e.qZA(),e.TgZ(11,"mat-select",7),e.YNc(12,re,2,3,"mat-option",8),e.qZA(),e.YNc(13,se,4,1,"mat-error",9),e.qZA()()(),e.TgZ(14,"div",10)(15,"div",11)(16,"button",12),e.NdJ("click",function(){return n.onNoClick()}),e._uU(17," Cancel "),e.qZA()(),e.TgZ(18,"div",13),e.YNc(19,de,2,1,"button",14),e.YNc(20,ce,2,1,"button",15),e.YNc(21,le,2,1,"button",15),e.qZA()()(),e.TgZ(22,"mat-step",2)(23,"div",3)(24,"form",4),e.YNc(25,Ze,4,1,"div",9),e.YNc(26,ze,4,1,"div",9),e.YNc(27,Se,4,1,"div",9),e.YNc(28,Me,2,0,"div",9),e.YNc(29,He,4,1,"div",9),e.qZA()(),e.TgZ(30,"div",10)(31,"div",11)(32,"button",12),e.NdJ("click",function(){return n.onNoClick()}),e._uU(33," Cancel "),e.qZA()(),e.TgZ(34,"div",16)(35,"button",17),e._uU(36," Back "),e.qZA(),e.TgZ(37,"button",18),e.NdJ("click",function(){return n.onNextToDetail()}),e._uU(38," Next "),e.qZA()()()()()),2&t&&(e.xp6(3),e.Q6J("stepControl",n.form),e.xp6(2),e.Q6J("formGroup",n.form),e.xp6(1),e.Q6J("form",n.form.get("config"))("fieldId",!1)("type","create")("change",n.checkValue),e.xp6(1),e.Q6J("formGroup",n.secondFormGroup),e.xp6(4),e.uIk("data-cy","zone.createType"),e.xp6(1),e.Q6J("ngForOf",n.createTypes),e.xp6(1),e.Q6J("ngIf",n.errorHandling("createType","required")),e.xp6(3),e.uIk("data-cy","create.first.cancel.button"),e.xp6(3),e.Q6J("ngIf",!n.form.valid||!n.secondFormGroup.get("createType").valid),e.xp6(1),e.Q6J("ngIf",n.form.valid&&n.secondFormGroup.get("createType").valid&&4!==n.secondFormGroup.get("createType").value&&6!==n.secondFormGroup.get("createType").value),e.xp6(1),e.Q6J("ngIf",n.form.valid&&n.secondFormGroup.get("createType").valid&&(4===n.secondFormGroup.get("createType").value||6===n.secondFormGroup.get("createType").value)),e.xp6(1),e.Q6J("stepControl",n.secondFormGroup),e.xp6(2),e.Q6J("formGroup",n.secondFormGroup),e.xp6(1),e.Q6J("ngIf",1===n.secondFormGroup.get("createType").value),e.xp6(1),e.Q6J("ngIf",2===n.secondFormGroup.get("createType").value),e.xp6(1),e.Q6J("ngIf",3===n.secondFormGroup.get("createType").value),e.xp6(1),e.Q6J("ngIf",4===n.secondFormGroup.get("createType").value||6===n.secondFormGroup.get("createType").value),e.xp6(1),e.Q6J("ngIf",5===n.secondFormGroup.get("createType").value),e.xp6(3),e.uIk("data-cy","create.second.cancel.button"),e.xp6(3),e.uIk("data-cy","create.second.back.button"),e.xp6(2),e.uIk("data-cy","create.second.next.button"))},dependencies:[f.sg,f.O5,l._Y,l.Fj,l.wV,l.JJ,l.JL,l.sg,l.u,l.x0,x.xw,x.Wh,x.yH,D.TO,D.KE,D.hX,D.qo,D.R9,ne.Nt,ae.gD,q.ey,q.X2,w.lW,R.XC,R.ZL,_.uh,_.xY,_.H8,$.Hw,N.C0,N.Vq,N.Ic,N.fd,V.h,ie.x,f.Ov],styles:[".pr12[_ngcontent-%COMP%]{padding-right:12px}.pl12[_ngcontent-%COMP%]{padding-left:12px}.list[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-top:18px}  .mat-form-field-appearance-outline.text-suffix .mat-form-field-suffix{top:-.25em!important}  .approx-position .mat-form-field-infix{border-top:0}  .approx-position input{line-height:2em;padding:.6em 0 0}"],changeDetection:0}),o})(),$e=(()=>{class o{constructor(t){this.dialogRef=t}onNoClick(){this.dialogRef.close(!1)}onDelete(){this.dialogRef.close(!0)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(_.so))},o.\u0275cmp=e.Xpm({type:o,selectors:[["deephub-delete-zone-dialog"]],decls:9,vars:0,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions","","fxLayout","row","fxLayoutAlign","end none"],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","","data-cy","zone.delete.button.2",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"h1",0),e._uU(1,"Delete zone"),e.qZA(),e.TgZ(2,"div",1),e._uU(3," This will delete the selected zone and cannot be undone\n"),e.qZA(),e.TgZ(4,"div",2)(5,"button",3),e.NdJ("click",function(){return n.onNoClick()}),e._uU(6,"Cancel"),e.qZA(),e.TgZ(7,"button",4),e.NdJ("click",function(){return n.onDelete()}),e._uU(8,"Delete"),e.qZA()())},dependencies:[x.xw,x.Wh,w.lW,_.uh,_.xY,_.H8],changeDetection:0}),o})();var Ve=s(77344),je=s(61135),I=s(39646),Xe=s(4128),Y=s(70262);function Ke(o,i){1&o&&(e.TgZ(0,"div",5),e._uU(1," No errors found in the files "),e.qZA())}function We(o,i){if(1&o&&(e.TgZ(0,"li")(1,"p"),e._uU(2),e.qZA()()),2&o){const t=i.$implicit;e.xp6(2),e.hij(" ",t.message," ")}}function et(o,i){if(1&o&&(e.TgZ(0,"div")(1,"h3",6),e._uU(2,"Errors"),e.qZA(),e.TgZ(3,"ul"),e.YNc(4,We,3,1,"li",7),e.qZA()()),2&o){const t=e.oxw().ngIf;e.xp6(4),e.Q6J("ngForOf",t.errors)}}function tt(o,i){1&o&&(e.TgZ(0,"div")(1,"p")(2,"strong"),e._uU(3,"add"),e.qZA(),e._uU(4," means existing zones remain and new zones are added"),e.qZA(),e.TgZ(5,"p")(6,"strong"),e._uU(7,"new"),e.qZA(),e._uU(8," means existing zones are deleted and new zones are added"),e.qZA()())}function ot(o,i){if(1&o&&(e.TgZ(0,"div"),e.YNc(1,Ke,2,0,"div",4),e.YNc(2,et,5,1,"div",2),e.YNc(3,tt,9,0,"div",2),e.qZA()),2&o){const t=i.ngIf;e.xp6(1),e.Q6J("ngIf",!t.errors.length),e.xp6(1),e.Q6J("ngIf",t.errors.length),e.xp6(1),e.Q6J("ngIf",!t.errors.length)}}function nt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onAdd())}),e._uU(1,"Add"),e.qZA()}}function at(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.onNew())}),e._uU(1,"New"),e.qZA()}}function it(o,i){1&o&&e._UZ(0,"mat-spinner",14),2&o&&e.Q6J("diameter",36)("color","accent")}function rt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"button",8),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onNoClick())}),e._uU(2,"Cancel"),e.qZA(),e.YNc(3,nt,2,0,"button",9),e.YNc(4,at,2,0,"button",10),e.YNc(5,it,1,2,"mat-spinner",11),e.qZA()}if(2&o){const t=i.ngIf,n=e.oxw();e.xp6(3),e.Q6J("ngIf",!t.errors.length),e.xp6(1),e.Q6J("ngIf",!t.errors.length),e.xp6(1),e.Q6J("ngIf",n.pushButton)}}let st=(()=>{class o{constructor(t,n,a){this.dialogRef=t,this.zoneFacade=a,this.subs=new J.Y,this.pushButton=!1,this.dataSubject=new je.X(null),this.data$=this.dataSubject.asObservable(),this.dataSubject.next(n)}ngOnDestroy(){this.subs.unsubscribe()}onNoClick(){this.dialogRef.close(!1)}onNew(){this.addZones(!0)}onAdd(){this.addZones()}addZones(t=!1){if(this.pushButton)return;this.pushButton=!0;const n=[];t&&n.push(this.zoneFacade.deleteAllZone());const a=this.dataSubject.getValue()?.filesData;for(const c of a){const p=c.zoneData;for(const m of p)n.push(this.zoneFacade.addZone(m).pipe((0,Y.K)(u=>(this.dataSubject.next({errors:[{message:u.message||"Invalid data."}],filesData:a}),(0,I.of)(u)))))}const r=(0,Xe.D)(n);this.subs.add(r.subscribe(c=>{this.pushButton=!1;for(const p of c)if(p instanceof Ve.VL)return;this.dialogRef.close(!0)}))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(_.so),e.Y36(_.WI),e.Y36(F.Xq))},o.\u0275cmp=e.Xpm({type:o,selectors:[["deephub-import-zone-dialog"]],decls:8,vars:6,consts:[["mat-dialog-title","","data-cy","zone-import-dialog-title"],["mat-dialog-content",""],[4,"ngIf"],["mat-dialog-actions",""],["data-cy","zone-import-dialog-no-errors",4,"ngIf"],["data-cy","zone-import-dialog-no-errors"],["data-cy","zone-import-dialog-errors"],[4,"ngFor","ngForOf"],["mat-button","","data-cy","zone-import-dialog-button-cancel",3,"click"],["mat-button","","cdkFocusInitial","","data-cy","zone-import-dialog-button-add",3,"click",4,"ngIf"],["mat-button","","data-cy","zone-import-dialog-button-new",3,"click",4,"ngIf"],[3,"diameter","color",4,"ngIf"],["mat-button","","cdkFocusInitial","","data-cy","zone-import-dialog-button-add",3,"click"],["mat-button","","data-cy","zone-import-dialog-button-new",3,"click"],[3,"diameter","color"]],template:function(t,n){1&t&&(e.TgZ(0,"h1",0),e._uU(1,"Import zone"),e.qZA(),e.TgZ(2,"div",1),e.YNc(3,ot,4,3,"div",2),e.ALo(4,"async"),e.qZA(),e.TgZ(5,"div",3),e.YNc(6,rt,6,3,"div",2),e.ALo(7,"async"),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",e.lcZ(4,2,n.data$)),e.xp6(3),e.Q6J("ngIf",e.lcZ(7,4,n.data$)))},dependencies:[f.sg,f.O5,w.lW,_.uh,_.xY,_.H8,f.Ov],changeDetection:0}),o})(),P=(()=>{class o extends C.zX{constructor(t,n,a,r,c){super(n,a),this.saveFileName="zoneData.json",this.validateService=r,this.dialog=c,this.zoneFacade=t}ngOnDestroy(){super.ngOnDestroy()}showImportView(t,n){const a=this.dialog.open(st,{width:"518px",data:{errors:t,filesData:n},disableClose:!0});this.subs.add(a.afterClosed().subscribe(r=>{r&&this.reloadData()}))}isType(t){let n=[];if(t){const a=this.validateService.validateSchema("zoneImportApiSchema",t);if(a&&(n=[...n,...a]),t.zoneData&&t.zoneData.length){const r=t.zoneData.length;for(let c=0;c<r;c++){const p=t.zoneData[c];if(p){const m=this.validateService.validateSchema("zoneImportSchema",p);m&&(n=[...n,...m])}}}}return n}getExportData(){return this.zoneFacade.getExportData()}reloadData(){this.subs.add(this.zoneFacade.loadZones().subscribe())}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(F.Xq),e.Y36(A.p),e.Y36(A.K),e.Y36(C.pY),e.Y36(_.uw))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ng-component"]],features:[e.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2}),o})(),dt=(()=>{class o extends P{constructor(t,n,a,r,c,p,m,u,h,Z,T,b){super(u,h,Z,T,b),this.router=t,this.activatedRoute=n,this.mapOneFacade=a,this.mapFacade=r,this.searchBarFacade=c,this.importExportFacade=p,this.mapZoomFacade=m,this.subs.add(this.activatedRoute.queryParams.pipe((0,k.P)()).subscribe(g=>{Object.keys(g).length||(this.mapZoomFacade.featuresZoom=!0)}),this.importExportFacade.importFiles$.subscribe(g=>{this.importFiles(g)}),this.importExportFacade.exportFiles$.subscribe(()=>{this.exportData()}),this.mapFacade.selectionchangeEvent.subscribe(g=>{g.id&&this.router.navigateByUrl(this.router.createUrlTree(["/map/zone",{outlets:{primary:["detail",g.id],right:["detail"]}}],{queryParams:{code:null,scope:null,state:null,session_state:null},relativeTo:this.activatedRoute,queryParamsHandling:"merge",preserveFragment:!0}))}))}ngOnInit(){this.mapOneFacade.showRightSidebar=!1,this.mapOneFacade.activSaveLeftSidebar=!1,this.mapFacade.setShowFilterButton=!1,this.router.navigateByUrl(this.router.createUrlTree(["/map/zone",{outlets:{left:["list"],right:null}}],{queryParams:{code:null,scope:null,state:null,session_state:null},relativeTo:this.activatedRoute,queryParamsHandling:"merge",preserveFragment:!0})),this.searchBarFacade.featureList$=this.zoneFacade.zonesFeatureList$,this.searchBarFacade.title="Search Zones, Locations",this.mapFacade.features=[this.zoneFacade.zonesFeatureList$],this.mapFacade.bgFeature=[this.zoneFacade.zonesLabelFeatureList$],this.zoneFacade.triggerLoadZones()}ngOnDestroy(){super.ngOnDestroy()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(v.F0),e.Y36(v.gz),e.Y36(M.$),e.Y36(d.yk),e.Y36(L.w),e.Y36(C.dw),e.Y36(d.tI),e.Y36(F.Xq),e.Y36(A.p),e.Y36(A.K),e.Y36(C.pY),e.Y36(_.uw))},o.\u0275cmp=e.Xpm({type:o,selectors:[["deephub-zone-show"]],features:[e.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),o})();var z=s(94613),j=s(17009);let ct=(()=>{class o extends P{constructor(t,n,a,r,c,p,m,u,h,Z,T,b,g,Et){super(Z,T,b,g,Et),this.router=t,this.activatedRoute=n,this.editFacade=a,this.snackBar=r,this.mapFacade=c,this.mapOneFacade=p,this.searchBarFacade=m,this.importExportFacade=u,this.mapZoomFacade=h,this.subs.add(this.importExportFacade.importFiles$.subscribe(Ot=>{this.importFiles(Ot)}),this.importExportFacade.exportFiles$.subscribe(()=>{this.exportData()}))}ngOnInit(){this.setRestView(),this.mapOneFacade.showRightSidebar=!1,this.mapOneFacade.activSaveLeftSidebar=!1,this.mapFacade.setShowFilterButton=!1,this.router.navigateByUrl(this.router.createUrlTree(["/map/zone",{outlets:{left:["list"],right:["detail"]}}],{queryParams:{code:null,scope:null,state:null,session_state:null},relativeTo:this.activatedRoute,queryParamsHandling:"merge",preserveFragment:!0})),this.searchBarFacade.featureList$=this.zoneFacade.zonesFeatureList$,this.searchBarFacade.title="Search Zones, Locations",this.mapFacade.features=[this.zoneFacade.zonesFeatureList$],this.mapFacade.bgFeature=[this.zoneFacade.zonesLabelFeatureList$];const t=this.dialog.open(Re,{width:"618px"});this.subs.add(t.afterClosed().subscribe(n=>{if(n){if(n.createType===y.Ll.DrawingOnMap)this.mapFacade.setDrawMode(),this.snackBar.open("Please click on the map to define the Ground Control Points of the Zone",void 0,{duration:5e3}),this.subs.add(this.mapFacade.finishCreateMode$.pipe((0,k.P)()).subscribe(a=>{a.properties={locCoordinates:a.coordinates[0].map(()=>[]),...a.properties,...this.zoneFacade.forms.get("config").value},this.mapOneFacade.showRightSidebar=!0,this.editFacade.editMode=d.Gt.CreateEdit,this.editFacade.setEditFeature(a)}));else if(n.createType===y.mg.DrawingOnMap)this.mapFacade.setDrawMode("draw_point"),this.snackBar.open("Please click on the map to define the Point of the Zone",null,{duration:5e3}),this.subs.add(this.mapFacade.finishCreateMode$.pipe((0,k.P)()).subscribe(a=>{a.properties={...a.properties,...this.zoneFacade.forms.get("config").value},this.mapOneFacade.showRightSidebar=!0,this.editFacade.editMode=d.Gt.CreateEdit,this.editFacade.setEditFeature(a)}));else if(n.createType===y.Ll.BasedGeometries){this.mapOneFacade.showRightSidebar=!0;const a=this.mapFacade.center(),r=new z.E9(a.lng,a.lat),c=n.subForm.width,p=n.subForm.height,m=z.fg.getRectangle(r,c,p),u=[];m.forEach(h=>{u.push([h.getX(),h.getY()])}),u.push([m[0].getX(),m[0].getY()]),this.setCreateNewPolygonZone(u,[[0,p],[c,p],[c,0],[0,0]])}else if(n.createType===y.Ll.LocalCoordinates){this.mapOneFacade.showRightSidebar=!0;const a=this.mapFacade.center(),r=n.subForm.list,c=new z.E9(a.lng,a.lat),p=[],m=[];r.forEach(Z=>{p.push(new z.E9(Z.x,Z.y)),m.push([Z.x,Z.y])});const u=z.fg.getRectangleFromLocal(c,p),h=[];u.forEach(Z=>{h.push([Z.getX(),Z.getY()])}),h.push([u[0].getX(),u[0].getY()]),this.setCreateNewPolygonZone(h,m)}else if(n.createType===y.Ll.GeographicCoordinates){this.mapOneFacade.showRightSidebar=!0;const a=n.subForm.list,r=[];a.forEach(u=>{r.push([u.longitude,u.latitude])});const c=[];a.forEach(u=>{c.push(new z.E9(u.longitude,u.latitude))});const p=z.fg.getForward(c);r.push([a[0].longitude,a[0].latitude]),this.setCreateNewPolygonZone(r,(u=>{const h=[],Z=u[3].getX(),T=u[3].getY();for(let b=0;b<u.length;b++)if(3===b)h.push([0,0]);else{const g=u[b];h.push([g.getX()-Z,g.getY()-T])}return h})(p))}else if(n.createType===y.mg.GeographicCoordinate){const a=n.subForm.list[0];this.setCreateNewPointZone({type:"Point",coordinates:[a.longitude,a.latitude]})}}else this.router.navigateByUrl(this.router.createUrlTree(["/map/zone",{outlets:{left:["list"],right:null,primary:["show"]}}],{relativeTo:this.activatedRoute,queryParamsHandling:"merge",preserveFragment:!0}))}))}ngOnDestroy(){super.ngOnDestroy()}setRestView(){this.editFacade.editMode=d.Gt.None,this.zoneFacade.resetForm(),this.editFacade.setId(null),this.editFacade.setForm(this.zoneFacade.forms)}setCreateNewPolygonZone(t,n){const a={type:"FeatureCollection",features:[{type:"Feature",id:"create",geometry:{type:"Polygon",coordinates:[t]},properties:{objType:"zone",...this.zoneFacade.forms.get("config").value}}]},r=this.mapFacade.addFeatureToDraw(a);this.mapOneFacade.showRightSidebar=!0,this.editFacade.editMode=d.Gt.CreateEdit,r.setProperty("locCoordinates",n),this.editFacade.setEditFeature(r),setTimeout(()=>{this.mapZoomFacade.zoom=!0,this.mapFacade.zoomTo(a,{padding:100})},100)}setCreateNewPointZone(t){const n={type:"FeatureCollection",features:[{type:"Feature",id:"create",geometry:t,properties:{objType:"zone",...this.zoneFacade.forms.get("config").value}}]},a=this.mapFacade.addFeatureToDraw(n);this.mapOneFacade.showRightSidebar=!0,this.editFacade.editMode=d.Gt.CreateEdit,this.editFacade.setEditFeature(a),setTimeout(()=>{this.mapZoomFacade.zoom=!0,this.mapFacade.zoomTo(n,{padding:100})},100)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(v.F0),e.Y36(v.gz),e.Y36(d.Eg),e.Y36(j.ux),e.Y36(d.yk),e.Y36(M.$),e.Y36(L.w),e.Y36(C.dw),e.Y36(d.tI),e.Y36(F.Xq),e.Y36(A.p),e.Y36(A.K),e.Y36(C.pY),e.Y36(_.uw))},o.\u0275cmp=e.Xpm({type:o,selectors:[["deephub-zone-create"]],features:[e.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),o})();var E=s(48262),lt=s(9313),ut=s(13360);let pt=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[f.ez,B.$]}),o})(),mt=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[f.ez,l.u5,v.Bz,l.UX,B.$,E.Lr,x.ae,lt.S,ut.x,y.gQ,d.Ct,pt]}),o})();class X{constructor(i,t,n,a,r,c,p){this.subs=new J.Y,this.dialog=i,this.mapFacade=t,this.mapZoomFacade=n,this.router=a,this.activatedRoute=r,this.editFacade=c,this.zoneFacade=p}deleteZone(i){const t=this.dialog.open($e,{width:"518px"});this.subs.add(t.afterClosed().subscribe(n=>{n&&this.subs.add(this.zoneFacade.deleteZone(i).subscribe(()=>{this.zoneFacade.triggerLoadZones(),this.mapFacade.deleteDrawFeature(i),this.mapZoomFacade.zoom=!1,this.setRestView(),this.router.navigateByUrl(this.router.createUrlTree(["/map/zone",{outlets:{primary:["show"]}}],{queryParams:{code:null,scope:null,state:null,session_state:null},relativeTo:this.activatedRoute,queryParamsHandling:"merge",preserveFragment:!0}))}))}))}setRestView(){this.editFacade.editMode=d.Gt.None,this.zoneFacade.resetForm(),this.editFacade.setId(null),this.editFacade.setForm(this.zoneFacade.forms),this.mapFacade.resize()}}var gt=s(48602),ht=s(23274),ft=s(56683),_t=s(87307),Zt=s(26805),Ft=s(36422);function vt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",16),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.propertiesEdit())}),e.ALo(1,"async"),e._uU(2," Edit properties "),e.qZA()}if(2&o){const t=e.oxw(2);let n;e.Q6J("disabled",(null==(n=e.lcZ(1,1,t.editFacade.form$))?null:n.disabled)||t.disabledProperties())}}function xt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",17),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.propertiesEdit())}),e.ALo(1,"async"),e._uU(2," Add properties "),e.qZA()}if(2&o){const t=e.oxw(2);let n;e.Q6J("disabled",(null==(n=e.lcZ(1,1,t.editFacade.form$))?null:n.disabled)||t.disabledProperties())}}function yt(o,i){if(1&o&&(e.TgZ(0,"div"),e._UZ(1,"deephub-field-coordinate",18),e.ALo(2,"async"),e.ALo(3,"async"),e.ALo(4,"async"),e.ALo(5,"async"),e.qZA()),2&o){const t=e.oxw(2);let n;e.xp6(1),e.Q6J("feature",e.lcZ(2,5,t.editFacade.editFeature$))("editMode",e.lcZ(3,7,t.editFacade.editMode$))("update",e.lcZ(4,9,t.editFacade.drawUpdate$))("domain","zone")("form",null==(n=e.lcZ(5,11,t.editFacade.form$))?null:n.get("coordinates").controls[0])}}function bt(o,i){if(1&o&&(e.TgZ(0,"div")(1,"h3"),e._uU(2,"Ground Control Points (GCP)"),e.qZA(),e._UZ(3,"deephub-field-ground-control-points",19),e.ALo(4,"async"),e.ALo(5,"async"),e.ALo(6,"async"),e.ALo(7,"async"),e.ALo(8,"async"),e.qZA()),2&o){const t=e.oxw(2);let n;e.xp6(3),e.Q6J("feature",e.lcZ(4,6,t.editFacade.editFeature$))("modifyIndex",e.lcZ(5,8,t.editFacade.modifyIndex$))("editMode",e.lcZ(6,10,t.editFacade.editMode$))("update",e.lcZ(7,12,t.editFacade.drawUpdate$))("domain","zone")("form",null==(n=e.lcZ(8,14,t.editFacade.form$))?null:n.get("coordinates"))}}function Ct(o,i){if(1&o&&(e.TgZ(0,"form",11),e.ALo(1,"async"),e._UZ(2,"deephub-form-zone-config",12),e.ALo(3,"async"),e.ALo(4,"async"),e.ALo(5,"async"),e.ALo(6,"async"),e.TgZ(7,"h3"),e._uU(8,"Custom Properties"),e.qZA(),e.YNc(9,vt,3,3,"button",13),e.ALo(10,"async"),e.YNc(11,xt,3,3,"button",14),e.ALo(12,"async"),e.YNc(13,yt,6,13,"div",15),e.ALo(14,"async"),e.YNc(15,bt,9,16,"div",15),e.ALo(16,"async"),e.qZA()),2&o){const t=e.oxw();let n,a,r,c,p,m,u;e.Q6J("formGroup",e.lcZ(1,9,t.editFacade.form$)),e.xp6(2),e.Q6J("form",null==(n=e.lcZ(3,11,t.editFacade.form$))?null:n.get("config"))("change",e.lcZ(4,13,e.lcZ(5,15,t.editFacade.form$).valueChanges))("showTransformation",(null==(a=e.lcZ(6,17,t.editFacade.form$))||null==(r=a.get("coordinates"))?null:r.length)>1)("type","edit"),e.xp6(7),e.Q6J("ngIf",e.lcZ(10,19,t.hasProperties())),e.xp6(2),e.Q6J("ngIf",!1===e.lcZ(12,21,t.hasProperties())),e.xp6(2),e.Q6J("ngIf",1===(null==(c=e.lcZ(14,23,t.editFacade.form$))||null==(p=c.get("coordinates"))?null:p.length)),e.xp6(2),e.Q6J("ngIf",(null==(m=e.lcZ(16,25,t.editFacade.form$))||null==(u=m.get("coordinates"))?null:u.length)>1)}}function Tt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.cancelDraw())}),e._uU(1," Cancel "),e.qZA()}}function At(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",21),e.NdJ("click",function(a){e.CHM(t);const r=e.oxw();return e.KtG(r.cancelEdit(a))}),e._uU(1," Cancel "),e.qZA()}}function zt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.deleteZone())}),e._uU(1," Delete "),e.qZA()}}let It=(()=>{class o extends X{constructor(t,n,a,r,c,p,m,u){let h;super(p,a,m,r,c,n,t),this.snackBar=u,this.subs.add(this.editFacade.editMode$.subscribe(Z=>{Z===d.Gt.Edit&&h!==d.Gt.Update&&this.editFacade.id&&this.subs.add(this.zoneFacade.loadZoneById(this.editFacade.id).subscribe(T=>{this.zoneFacade.updateFeature(this.editFacade.editFeature,T),this.editFacade.updateForm()})),h=Z}))}ngOnDestroy(){this.subs.unsubscribe()}cancelDraw(){(this.editFacade.editMode===d.Gt.Create||this.editFacade.editMode===d.Gt.CreateEdit)&&this.mapFacade.cancelDraw(),this.router.navigateByUrl(this.router.createUrlTree(["/map/zone",{outlets:{primary:["show"]}}],{queryParams:{code:null,scope:null,state:null,session_state:null},relativeTo:this.activatedRoute,queryParamsHandling:"merge",preserveFragment:!0}))}showDrawCancelButton(){return this.editFacade.editMode===d.Gt.Create||this.editFacade.editMode===d.Gt.CreateEdit}showEditCancelButton(){return this.editFacade.editMode===d.Gt.Edit}showDeleteButton(){return!(this.editFacade.editMode===d.Gt.Create||this.editFacade.editMode===d.Gt.CreateEdit)}setHideMode(){return this.editFacade.editFeature?.properties?.incomplete_configuration}cancelEdit(t){t.preventDefault(),t.stopPropagation(),this.editFacade.editMode===d.Gt.Edit&&(this.editFacade.editMode=d.Gt.None),this.editFacade.formDisable(),this.resetFeature(),this.router.navigateByUrl(this.router.createUrlTree(["/map/zone",{outlets:{primary:["show"]}}],{queryParams:{code:null,scope:null,state:null,session_state:null},relativeTo:this.activatedRoute,queryParamsHandling:"merge",preserveFragment:!0}))}resetFeature(){!this.editFacade.id||this.zoneFacade.resetFeature(this.editFacade.editFeature)}saveNext(){if(!this.editFacade.getValidForm("coordinates")&&this.editFacade.getForm().value.coordinates.length>1)return this.editFacade.markAllAsTouched(),void this.snackBar.open("Please check all Ground Control Points",null,{duration:1e4,panelClass:"error"});this.editFacade.getValidForm()?this.subs.add(this.zoneFacade.createZone(this.editFacade.getForm().value,this.editFacade.editFeature).pipe((0,Y.K)(t=>(this.snackBar.open(t.message,null,{duration:1e4,panelClass:"error"}),(0,I.of)(null))),(0,G.w)(t=>this.zoneFacade.loadZones().pipe((0,U.U)(()=>t)))).subscribe(t=>{!t||this.router.navigateByUrl(this.router.createUrlTree(["/map/zone",{outlets:{primary:["show"]}}],{relativeTo:this.activatedRoute,queryParamsHandling:"merge",preserveFragment:!0}))})):this.editFacade.markAllAsTouched()}editNext(){this.editFacade.editMode=d.Gt.Edit}updateNext(){if(this.editFacade.editMode=d.Gt.Update,!this.editFacade.getValidForm("coordinates")&&this.editFacade.getForm().value.coordinates.length>1)return this.snackBar.open("Please check all Ground Control Points",null,{duration:1e4,panelClass:"error"}),void(this.editFacade.editMode=d.Gt.Edit);if(!this.editFacade.getValidForm())return this.editFacade.editMode=d.Gt.Edit,void this.editFacade.markAllAsTouched();const t=this.zoneFacade.getZoneById(this.editFacade.id),n=this.editFacade.getForm().value;n.properties=t.properties,this.subs.add(this.zoneFacade.updateZone(n,this.editFacade.editFeature).pipe((0,Y.K)(a=>(this.snackBar.open(a.message,null,{duration:1e4,panelClass:"error"}),(0,I.of)(null)))).subscribe(a=>{a?(this.mapZoomFacade.zoom=!1,this.editFacade.formDisable(),this.zoneFacade.triggerLoadZones(),this.editFacade.id=null,this.editFacade.editMode=d.Gt.None,this.router.navigateByUrl(this.router.createUrlTree(["/map/zone",{outlets:{primary:["show"]}}],{relativeTo:this.activatedRoute,queryParamsHandling:"merge",preserveFragment:!0}))):this.editFacade.editMode=d.Gt.Edit}))}deleteZone(){super.deleteZone(this.editFacade.id)}disabledProperties(){return this.editFacade.editMode===d.Gt.CreateEdit}hasProperties(){return(0,I.of)(this.zoneFacade.getZoneById(this.editFacade.id)).pipe((0,U.U)(t=>{if(!t||!t.properties)return!1;const n=t.properties;return!(!n||!Object.keys(n).length)}))}saveProperties(t){return this.editFacade.form$.pipe((0,G.w)(n=>{if(!n)return(0,I.of)(null);const a=this.editFacade.getForm().value;return a.properties=t,n.disable(),this.zoneFacade.updateZone(a,this.editFacade.editFeature).pipe((0,U.U)(r=>{const c=this.zoneFacade.getZoneById(r.id);c&&(c.properties=r.properties),n.enable()}),(0,Y.K)(r=>(this.snackBar.open(r.message,null,{duration:1e4,panelClass:"error"}),(0,I.of)(null))))}))}resetProperties(){return this.editFacade.form$.pipe((0,U.U)(t=>{if(!t)return null;const n=this.zoneFacade.getZoneById(this.editFacade.id);t.patchValue({properties:n.properties})}))}propertiesEdit(){const t=this.zoneFacade.getZoneById(this.editFacade.id),n=this.dialog.open(gt.f6,{width:"800px",panelClass:"full-height",maxHeight:"70vh",minHeight:"400px",data:{value:t.properties,update:a=>this.saveProperties(a),reset:this.resetProperties()}});this.subs.add(n.afterClosed().subscribe())}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(F.Xq),e.Y36(d.Eg),e.Y36(d.yk),e.Y36(v.F0),e.Y36(v.gz),e.Y36(_.uw),e.Y36(d.tI),e.Y36(j.ux))},o.\u0275cmp=e.Xpm({type:o,selectors:[["deephub-zone-side-detail"]],features:[e.qOj],decls:17,vars:7,consts:[["fxLayout","column","fxLayoutAlign","space-between none",2,"height","100%"],["fxFlex","",1,"zone-list"],[1,"pr16","pl16"],[3,"formGroup",4,"ngIf"],["fxFlex","none","fxLayout","column","fxLayoutAlign","end stretch",1,"pr16","pl16"],["mat-line","","mat-stroked-button","","color","primary","class","mb8","data-cy","zone.create.button.cancel",3,"click",4,"ngIf"],["mat-line","","mat-stroked-button","","color","primary","class","mb8","data-cy","zone.edit.button.cancel",3,"click",4,"ngIf"],["mat-flat-button","","color","primary","deephubCreateEditButton","","data-cy","zone.createEdit.button.create",1,"mb8",3,"pushClick"],["mat-line","","mat-stroked-button","","color","primary","deephubEditButton","","data-cy","zone.none.button.edit",1,"mb8",3,"hideMode","pushClick"],["mat-flat-button","","color","primary","deephubUpdateButton","","data-cy","zone.edit.button.update",1,"mb8",3,"pushClick"],["mat-line","","mat-stroked-button","","color","primary","class","mb8","data-cy","zone.side.detail.button.delete.1",3,"click",4,"ngIf"],[3,"formGroup"],[3,"form","change","showTransformation","type"],["type","button","mat-line","","mat-stroked-button","","color","primary","data-cy","zone.create.button.edit.properties",3,"disabled","click",4,"ngIf"],["type","button","mat-line","","mat-stroked-button","","color","primary","data-cy","zone.create.button.add.properties",3,"disabled","click",4,"ngIf"],[4,"ngIf"],["type","button","mat-line","","mat-stroked-button","","color","primary","data-cy","zone.create.button.edit.properties",3,"disabled","click"],["type","button","mat-line","","mat-stroked-button","","color","primary","data-cy","zone.create.button.add.properties",3,"disabled","click"],[3,"feature","editMode","update","domain","form"],[3,"feature","modifyIndex","editMode","update","domain","form"],["mat-line","","mat-stroked-button","","color","primary","data-cy","zone.create.button.cancel",1,"mb8",3,"click"],["mat-line","","mat-stroked-button","","color","primary","data-cy","zone.edit.button.cancel",1,"mb8",3,"click"],["mat-line","","mat-stroked-button","","color","primary","data-cy","zone.side.detail.button.delete.1",1,"mb8",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3"),e._uU(4,"Detail"),e.qZA(),e.YNc(5,Ct,17,27,"form",3),e.ALo(6,"async"),e.qZA()(),e.TgZ(7,"div",4),e.YNc(8,Tt,2,0,"button",5),e.YNc(9,At,2,0,"button",6),e.TgZ(10,"button",7),e.NdJ("pushClick",function(){return n.saveNext()}),e._uU(11," Save "),e.qZA(),e.TgZ(12,"button",8),e.NdJ("pushClick",function(){return n.editNext()}),e._uU(13," Edit "),e.qZA(),e.TgZ(14,"button",9),e.NdJ("pushClick",function(){return n.updateNext()}),e._uU(15," Save "),e.qZA(),e.YNc(16,zt,2,0,"button",10),e.qZA()()),2&t&&(e.xp6(5),e.Q6J("ngIf",e.lcZ(6,5,n.editFacade.form$)),e.xp6(3),e.Q6J("ngIf",n.showDrawCancelButton()),e.xp6(1),e.Q6J("ngIf",n.showEditCancelButton()),e.xp6(3),e.Q6J("hideMode",n.setHideMode()),e.xp6(4),e.Q6J("ngIf",n.showDeleteButton()))},dependencies:[f.O5,l._Y,l.JL,l.sg,q.X2,w.lW,x.xw,x.Wh,x.yH,ht.U,ft.t,V.h,_t.p,Zt.D,Ft.E,f.Ov],styles:[".zone-list[_ngcontent-%COMP%]{color:#878787;overflow:auto}"],changeDetection:0}),o})();var Ut=s(60873),Dt=s(44850),S=s(37084),K=s(90782);function wt(o,i){1&o&&e._UZ(0,"div",9),2&o&&e.Q6J("ngClass","zone-legend-closed_item zone-type-"+i.$implicit.type)}function kt(o,i){if(1&o&&(e.TgZ(0,"div",7),e.YNc(1,wt,1,1,"div",8),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.node)}}function qt(o,i){if(1&o&&(e.TgZ(0,"mat-grid-tile",10),e._UZ(1,"img",11),e._uU(2),e.qZA()),2&o){const t=i.$implicit;e.xp6(1),e.Q6J("src","assets/map-Icons/"+t.icon+".svg",e.LSH),e.xp6(1),e.hij(" ",t.name," ")}}let Nt=(()=>{class o{constructor(){this.panelOpenState=!1,this.node=y.f9}nextLine(t){return!(t%4)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["deephub-zone-legend"]],decls:10,vars:4,consts:[[1,"zone-legend"],[3,"opened","closed"],["data-cy","zone.legend.header"],["data-cy","zone.legend.panel.description"],["class","zone-legend-closed",4,"ngIf"],["cols","3",3,"rowHeight"],["data-cy","zone.legend.panel.item",4,"ngFor","ngForOf"],[1,"zone-legend-closed"],["data-cy","zone.legend.header.item",3,"ngClass",4,"ngFor","ngForOf"],["data-cy","zone.legend.header.item",3,"ngClass"],["data-cy","zone.legend.panel.item"],["alt","",1,"zone-legend-icon",3,"src"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"mat-accordion")(2,"mat-expansion-panel",1),e.NdJ("opened",function(){return n.panelOpenState=!0})("closed",function(){return n.panelOpenState=!1}),e.TgZ(3,"mat-expansion-panel-header",2)(4,"mat-panel-description",3),e.YNc(5,kt,2,1,"div",4),e._uU(6),e.qZA()(),e.TgZ(7,"div")(8,"mat-grid-list",5),e.YNc(9,qt,3,2,"mat-grid-tile",6),e.qZA()()()()()),2&t&&(e.xp6(5),e.Q6J("ngIf",!n.panelOpenState),e.xp6(1),e.hij(" ",n.panelOpenState?"Zone Types":""," "),e.xp6(2),e.Q6J("rowHeight",50),e.xp6(1),e.Q6J("ngForOf",n.node))},dependencies:[f.mk,f.sg,f.O5,S.pp,S.ib,S.yz,S.u4,K.Il,K.DX],styles:[".zone-legend-closed[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;place-content:center flex-start}.zone-legend-closed_item[_ngcontent-%COMP%]{display:list-item;list-style-type:none;width:10px;height:10px;margin-right:4px}.zone-legend-closed_item[_ngcontent-%COMP%]:last-child{margin-right:0}.zone-legend-icon[_ngcontent-%COMP%]{width:30px;height:100%;margin-right:5px}"],changeDetection:0}),o})();const Yt=function(o,i){return{active:o,incomplete:i}};function St(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",11),e.NdJ("click",function(a){const c=e.CHM(t).$implicit,p=e.oxw();return e.KtG(p.clickListItem(a,c.id))}),e.ALo(2,"async"),e.TgZ(3,"div",12)(4,"div",13)(5,"div",14)(6,"div",15)(7,"h4",16),e._uU(8),e.qZA(),e.TgZ(9,"span"),e._uU(10),e.qZA()(),e.TgZ(11,"div",17)(12,"button",18),e.NdJ("click",function(){const r=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.deleteZone(r.id))}),e.O4$(),e.TgZ(13,"svg",19)(14,"title"),e._uU(15,"delete"),e.qZA(),e._UZ(16,"path",20)(17,"path",21),e.qZA()()()()()()(),e.BQk()}if(2&o){const t=i.$implicit,n=i.index,a=e.oxw();e.xp6(1),e.Q6J("ngStyle",a.getListStyle(t.type))("ngClass",e.WLB(9,Yt,t.id===e.lcZ(2,7,a.editFacade.id$),t.incomplete_configuration)),e.xp6(6),e.uIk("data-cy-id","zone.list.element.id."+t.id)("data-cy-name","zone.list.element.name."+a.removeSpace(t.name))("data-cy-index","zone.list.index."+n),e.xp6(1),e.hij(" ",t.name," "),e.xp6(2),e.hij(" Floor ",t.floor," ")}}const Mt=function(){return["/map/zone","create"]};let Lt=(()=>{class o extends X{constructor(t,n,a,r,c,p,m,u){super(p,a,m,r,c,n,t),this.importExportFacade=u}ngOnDestroy(){this.subs.unsubscribe()}ngAfterViewInit(){this.subs.add(this.editFacade.id$.subscribe(t=>{this.scrollTo(t)}),this.zoneFacade.zonesList$.subscribe(()=>{this.scrollTo(this.editFacade.id)}))}clickListItem(t,n){t.preventDefault(),t.stopPropagation(),n!==this.editFacade.id&&(this.mapZoomFacade.zoom=!0,this.router.navigateByUrl(this.router.createUrlTree(["/map/zone",{outlets:{primary:["detail",n]}}],{relativeTo:this.activatedRoute,queryParamsHandling:"merge",preserveFragment:!0})))}getListStyle(t){return{"border-left":`10px solid ${Ut.LN[t]}`}}openFileSelector(){this.importExportFacade.pushButtonExportSubject.next(!0)}exportData(){this.importExportFacade.exportFilesSubject.next(!0)}zoneTrackByFunction(t,n){return n.id}removeSpace(t){return t?t.toString().replace(/\s+/g,""):""}scrollTo(t){if(t&&this.virtualScroller){const n=this.zoneFacade.getIndexForList(t);null!==n&&this.virtualScroller.scrollToIndex(n)}}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(F.Xq),e.Y36(d.Eg),e.Y36(d.yk),e.Y36(v.F0),e.Y36(v.gz),e.Y36(_.uw),e.Y36(d.tI),e.Y36(C.dw))},o.\u0275cmp=e.Xpm({type:o,selectors:[["deephub-zone-side-list"]],viewQuery:function(t,n){if(1&t&&e.Gf(E.Vw,5),2&t){let a;e.iGM(a=e.CRH())&&(n.virtualScroller=a.first)}},features:[e.qOj],decls:19,vars:8,consts:[["fxLayout","column","fxLayoutAlign","space-between none",1,"zone-list",2,"height","100%"],["mat-line","","mat-stroked-button","","color","primary",1,"createButton",3,"routerLink","queryParamsHandling"],[1,"with-icon"],["fxFlex","none"],["fxFlex","","data-cy","zone.list.virtual",1,"zoneEvent",3,"items"],["scroll",""],[4,"ngFor","ngForOf","ngForTrackBy"],["fxFlex","none","fxLayout","column","fxLayoutAlign","end stretch",1,"pr16","pl16","mt10"],["data-cy","zone-export-open","mat-line","","mat-stroked-button","","color","primary",1,"mb8",3,"click"],["data-cy","zone-import-open","mat-line","","mat-stroked-button","","color","primary",1,"mb8",3,"click"],["fxFlex","none","fxLayout","column","fxLayoutAlign","end stretch"],[1,"zoneEvent-item",3,"ngStyle","ngClass","click"],[1,"zoneEvent-item-content"],[1,"item-text"],["mat-line","","fxLayout","row","fxLayoutAlign","center center"],["fxFlex","90","fxLayout","column"],["mat-line","","data-cy","zone.list.element"],["fxFlex","10",1,"hover-show"],["mat-flat-button","","color","primary","data-cy","zone.delete.button.1",1,"button-small",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24"],["d","M19.5,7.5H4.5A.5.5,0,0,0,4,8V22a2,2,0,0,0,2,2H18a2,2,0,0,0,2-2V8A.5.5,0,0,0,19.5,7.5Zm-9.25,13a.75.75,0,0,1-1.5,0v-9a.75.75,0,0,1,1.5,0Zm5,0a.75.75,0,0,1-1.5,0v-9a.75.75,0,0,1,1.5,0Z"],["d","M22,4H17.25A.25.25,0,0,1,17,3.75V2.5A2.5,2.5,0,0,0,14.5,0h-5A2.5,2.5,0,0,0,7,2.5V3.75A.25.25,0,0,1,6.75,4H2A1,1,0,0,0,2,6H22a1,1,0,0,0,0-2ZM9,3.75V2.5A.5.5,0,0,1,9.5,2h5a.5.5,0,0,1,.5.5V3.75a.25.25,0,0,1-.25.25H9.25A.25.25,0,0,1,9,3.75Z"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"button",1)(2,"div",2)(3,"mat-icon"),e._uU(4,"add"),e.qZA(),e._uU(5," New Zone "),e.qZA()(),e._UZ(6,"mat-divider",3),e.TgZ(7,"virtual-scroller",4,5),e.ALo(9,"async"),e.YNc(10,St,18,12,"ng-container",6),e.qZA(),e._UZ(11,"mat-divider",3),e.TgZ(12,"div",7)(13,"button",8),e.NdJ("click",function(){return n.exportData()}),e._uU(14," Export all zones "),e.qZA(),e.TgZ(15,"button",9),e.NdJ("click",function(){return n.openFileSelector()}),e._uU(16," Import zones "),e.qZA()(),e.TgZ(17,"div",10),e._UZ(18,"deephub-zone-legend"),e.qZA()()),2&t){const a=e.MAs(8);e.xp6(1),e.Q6J("routerLink",e.DdM(7,Mt))("queryParamsHandling","merge"),e.xp6(6),e.Q6J("items",e.lcZ(9,5,n.zoneFacade.zonesList$)),e.xp6(3),e.Q6J("ngForOf",a.viewPortItems)("ngForTrackBy",n.zoneTrackByFunction)}},dependencies:[f.mk,f.sg,f.PC,v.rH,q.X2,Dt.d,w.lW,$.Hw,E.Vw,x.xw,x.Wh,x.yH,Nt,f.Ov],styles:[".zone-list[_ngcontent-%COMP%]{overflow:auto}.createButton[_ngcontent-%COMP%]{margin:10px 16px}.zoneEvent[_ngcontent-%COMP%]   .zoneEvent-item[_ngcontent-%COMP%]{height:72px;cursor:pointer}.zoneEvent[_ngcontent-%COMP%]   .zoneEvent-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{line-height:normal;color:#878787}.zoneEvent[_ngcontent-%COMP%]   .zoneEvent-item[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{font-size:8px}.zoneEvent[_ngcontent-%COMP%]   .zoneEvent-item-content[_ngcontent-%COMP%]{display:flex;padding:0 16px;flex-direction:row;align-items:center;box-sizing:border-box;position:relative;height:inherit}.zoneEvent[_ngcontent-%COMP%]   .item-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden;padding:0}.zoneEvent[_ngcontent-%COMP%]   .item-text[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin:0;padding:0;font-weight:400}.event-line[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;box-sizing:border-box}.zoneEvent-item.incomplete[_ngcontent-%COMP%]{background-color:#b3766b33}.zoneEvent-item.active[_ngcontent-%COMP%], .zoneEvent-item[_ngcontent-%COMP%]:hover{background-color:#0000000a}.zoneEvent-item[_ngcontent-%COMP%]:focus{outline:0}"],changeDetection:0}),o})(),Jt=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[f.ez]}),o})();var Gt=s(81397);const W=[{path:"",component:(()=>{class o{constructor(t,n){this.router=t,this.activatedRoute=n}ngOnInit(){this.router.navigateByUrl(this.router.createUrlTree(["/map/zone",{outlets:{primary:["show"],left:["list"]}}],{queryParams:{code:null,scope:null,state:null,session_state:null},relativeTo:this.activatedRoute,queryParamsHandling:"merge",preserveFragment:!0}))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(v.F0),e.Y36(v.gz))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ng-component"]],decls:0,vars:0,template:function(t,n){},encapsulation:2}),o})()},{path:"create",component:ct},{path:"show",component:dt},{path:"list",component:Lt,outlet:"left"},{path:"detail",component:It,outlet:"right"},{path:"detail/:zoneId",component:(()=>{class o extends P{constructor(t,n,a,r,c,p,m,u,h,Z,T,b){super(u,h,Z,T,b),this.router=t,this.activatedRoute=n,this.mapOneFacade=a,this.mapFacade=r,this.editFacade=c,this.searchBarFacade=p,this.importExportFacade=m,this.subs.add(this.importExportFacade.importFiles$.subscribe(g=>{this.importFiles(g)}),this.importExportFacade.exportFiles$.subscribe(()=>{this.exportData()}),this.activatedRoute.data.subscribe(g=>{this.router.navigateByUrl(this.router.createUrlTree(["/map/zone",{outlets:{left:["list"],right:["detail"]}}],{queryParams:{code:null,scope:null,state:null,session_state:null},relativeTo:this.activatedRoute,queryParamsHandling:"merge",preserveFragment:!0})),this.setRestView(),this.setDetailView(g.setting)}),this.mapFacade.selectionchangeEvent.subscribe(g=>{if(this.editFacade.editMode!==d.Gt.CreateEdit&&this.editFacade.editMode!==d.Gt.Create)if(g.id&&g.featureId){if(g.mode===Gt.modes.DIRECT_SELECT&&(this.editFacade.editMode=d.Gt.Edit),this.editFacade.editFeature&&this.editFacade.editFeature.id===g.featureId)return;if(this.editFacade.id===g.id)return void this.editNext();this.editFacade.id!==g.id&&this.router.navigateByUrl(this.router.createUrlTree(["/map/zone",{outlets:{primary:["detail",g.id],right:["detail"]}}],{relativeTo:this.activatedRoute,queryParamsHandling:"merge",preserveFragment:!0}))}else{if(this.editFacade.editMode===d.Gt.Select)return;this.resetFeature(),this.editFacade.editMode=d.Gt.None,this.editFacade.setId(null),this.router.navigateByUrl(this.router.createUrlTree(["/map/zone",{outlets:{primary:["show"]}}],{relativeTo:this.activatedRoute,queryParamsHandling:"merge",preserveFragment:!0}))}}))}ngOnInit(){this.mapOneFacade.activSaveLeftSidebar=!1,this.mapFacade.setShowFilterButton=!1,this.searchBarFacade.featureList$=this.zoneFacade.zonesFeatureList$,this.searchBarFacade.title="Search Zones, Locations",this.mapFacade.features=[this.zoneFacade.zonesFeatureList$],this.mapFacade.bgFeature=[this.zoneFacade.zonesLabelFeatureList$]}ngOnDestroy(){super.ngOnDestroy(),this.editFacade.setId(null)}setDetailView(t){this.editFacade.setId(t.zoneId),this.mapOneFacade.showRightSidebar=!0}setRestView(){this.mapOneFacade.showRightSidebar=!1,this.editFacade.editMode=d.Gt.None,this.zoneFacade.resetForm(),this.editFacade.setId(null),this.editFacade.setForm(this.zoneFacade.forms)}resetFeature(){!this.editFacade.id||this.zoneFacade.resetFeature(this.editFacade.editFeature)}editNext(){this.editFacade.editMode=d.Gt.Edit}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(v.F0),e.Y36(v.gz),e.Y36(M.$),e.Y36(d.yk),e.Y36(d.Eg),e.Y36(L.w),e.Y36(C.dw),e.Y36(F.Xq),e.Y36(A.p),e.Y36(A.K),e.Y36(C.pY),e.Y36(_.uw))},o.\u0275cmp=e.Xpm({type:o,selectors:[["deephub-zone-detail"]],features:[e.qOj],decls:0,vars:0,template:function(t,n){},encapsulation:2,changeDetection:0}),o})(),resolve:{setting:y.UP}}];let Pt=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[f.ez,v.Bz.forChild(W),y.gQ,Jt,mt]}),o})()}}]);