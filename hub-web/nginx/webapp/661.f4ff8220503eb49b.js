"use strict";(self.webpackChunkhub_admin=self.webpackChunkhub_admin||[]).push([[661],{52661:(O,c,t)=>{t.r(c),t.d(c,{SubscriptionComponent:()=>T});var e=t(94650),m=t(36895),s=t(24006),p=t(17009),u=t(63900),g=t(70262),d=t(54004),h=t(39646),v=t(15439),y=t(74521),C=t(33165),r=t(59549),Z=t(44144),x=t(4859);function b(o,a){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2,"Trial license end"),e.qZA(),e.TgZ(3,"div",1),e._uU(4),e.ALo(5,"async"),e.qZA()()),2&o){const i=e.oxw();let n;e.xp6(4),e.hij(" ",i.getTimeFormat(null==(n=e.lcZ(5,1,i.lease$))?null:n.trial_end_timestamp)," ")}}function M(o,a){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," You must provide a "),e.TgZ(2,"strong"),e._uU(3,"license key"),e.qZA()()),2&o&&e.uIk("data-cy","subscription.license_key.error.required")}let T=(()=>{class o{constructor(){this.licenseFacade=(0,e.f3M)(y.Cx),this.fb=(0,e.f3M)(s.qu),this.snackBar=(0,e.f3M)(p.ux),this.format="DD.MM.YYYY - HH:mm:ss",this.lease$=this.licenseFacade.lease$,this.info$=this.licenseFacade.info$}ngOnInit(){this.form=this.fb.group({license_key:["",s.kI.required]}),this.licenseType$=this.lease$.pipe((0,u.w)(i=>this.info$.pipe((0,d.U)(n=>(console.log(n),i?.is_trial?"trial":n&&!n.trial_info?"production":"development")))))}getTimeFormat(i){return v(i).format(this.format)}updateLicenseKey(){if(this.form&&this.form.valid){const i=this.form.value;this.form.disable(),this.licenseFacade.updateLicenseKey(i).pipe((0,d.U)(()=>{this.snackBar.open("License key saved",void 0,{duration:1e4}),this.form?.reset()}),(0,g.K)(n=>(this.snackBar.open(n.message,void 0,{duration:1e4,panelClass:"error"}),(0,h.of)())),(0,u.w)(()=>this.licenseFacade.getLeaseInfo())).subscribe(()=>{this.form?.enable()})}}errorHandling(i,n){return this.form?.controls[i].hasError(n)}}return o.\u0275fac=function(i){return new(i||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["deephub-subscription"]],standalone:!0,features:[e.jDz],decls:34,vars:13,consts:[[1,"row"],[1,"w30"],["class","row",4,"ngIf"],["href","https://flowcate.com/contact-us/","target","_blank"],[1,"w70","p0","m0","column",3,"formGroup"],["appearance","outline",1,"full-width"],["matInput","","placeholder","License Key","formControlName","license_key"],[4,"ngIf"],["mat-flat-button","","color","primary","data-cy","licenseKey.button.update",1,"mb8",3,"click"]],template:function(i,n){if(1&i&&(e.TgZ(0,"div")(1,"h2"),e._uU(2,"License Info"),e.qZA(),e.TgZ(3,"div",0)(4,"div",1),e._uU(5,"License type"),e.qZA(),e.TgZ(6,"div",1),e._uU(7),e.ALo(8,"async"),e.qZA()(),e.YNc(9,b,6,3,"div",2),e.ALo(10,"async"),e.TgZ(11,"div",0)(12,"div",1),e._uU(13,"Customer email"),e.qZA(),e.TgZ(14,"div",1),e._uU(15),e.ALo(16,"async"),e.qZA()(),e.TgZ(17,"div",0)(18,"div",1)(19,"a",3),e._uU(20,"License Purchase Request"),e.qZA()()(),e.TgZ(21,"div",0)(22,"div",1)(23,"h3"),e._uU(24,"Change license"),e.qZA()(),e.TgZ(25,"fieldset",4)(26,"mat-form-field",5)(27,"mat-label"),e._uU(28,"License Key"),e.qZA(),e._UZ(29,"input",6),e.YNc(30,M,4,1,"mat-error",7),e.qZA(),e.TgZ(31,"div",1)(32,"button",8),e.NdJ("click",function(){return n.updateLicenseKey()}),e._uU(33," Apply "),e.qZA()()()()()),2&i){let l,f;e.xp6(7),e.Oqu(e.lcZ(8,7,n.licenseType$)),e.xp6(2),e.Q6J("ngIf",null==(l=e.lcZ(10,9,n.lease$))?null:l.is_trial),e.xp6(5),e.uIk("data-cy","subscription.license.customer_email"),e.xp6(1),e.hij(" ",null==(f=e.lcZ(16,11,n.lease$))?null:f.customer_email," "),e.xp6(10),e.Q6J("formGroup",n.form),e.xp6(4),e.uIk("data-cy","subscription.license.license_key"),e.xp6(1),e.Q6J("ngIf",n.errorHandling("license_key","required"))}},dependencies:[m.Ov,m.O5,C.$,r.TO,r.KE,r.hX,Z.Nt,x.lW,s.u5,s.Fj,s.JJ,s.JL,s.UX,s.sg,s.u],styles:["[_nghost-%COMP%]{padding:20px;width:100%;max-width:1024px;margin:0 auto}fieldset[_ngcontent-%COMP%]{width:100%}.w30[_ngcontent-%COMP%]{max-width:30%;height:48px;align-items:center;display:flex}.w50[_ngcontent-%COMP%]{max-width:50%;align-items:center;display:flex}.w70[_ngcontent-%COMP%]{max-width:70%;align-items:center;display:flex}.row[_ngcontent-%COMP%], .column[_ngcontent-%COMP%]{box-sizing:border-box;display:flex;place-content:flex-start;align-items:flex-start}.row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%], .column[_ngcontent-%COMP%]   div[_ngcontent-%COMP%], .column[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1 1 100%;box-sizing:border-box}.column[_ngcontent-%COMP%]{flex-direction:column}.row[_ngcontent-%COMP%]{flex-direction:row}"],changeDetection:0}),o})()}}]);